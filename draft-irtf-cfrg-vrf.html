<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Verifiable Random Functions (VRFs)</title>
<meta content="Sharon Goldberg" name="author">
<meta content="Leonid Reyzin" name="author">
<meta content="Dimitrios Papadopoulos" name="author">
<meta content="Jan Vcelak" name="author">
<meta content="
       
        A Verifiable Random Function (VRF) is the public-key version of a
        keyed cryptographic hash. Only the holder of the private key
        can compute the hash, but anyone with the public key
        can verify the correctness of the hash.    
        VRFs are useful for preventing enumeration of hash-based data structures.
        This document specifies several VRF constructions based on RSA and Elliptic Curves that are secure in
        the cryptographic random oracle model.
       
    " name="description">
<meta content="xml2rfc 3.11.1" name="generator">
<meta content="public key cryptography" name="keyword">
<meta content="hashing" name="keyword">
<meta content="authenticated denial" name="keyword">
<meta content="draft-irtf-cfrg-vrf-11" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.11.1
    Python 3.9.2
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.4
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.26.0
    setuptools 49.2.1
    six 1.16.0
-->
<link href="draft-irtf-cfrg-vrf.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">VRF</td>
<td class="right">February 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Goldberg, et al.</td>
<td class="center">Expires 8 August 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">CFRG</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-irtf-cfrg-vrf-11</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-02-04" class="published">4 February 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-08-08">8 August 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Goldberg</div>
<div class="org">Boston University</div>
</div>
<div class="author">
      <div class="author-name">L. Reyzin</div>
<div class="org">Boston University and Algorand</div>
</div>
<div class="author">
      <div class="author-name">D. Papadopoulos</div>
<div class="org">Hong Kong University of Science and Technology</div>
</div>
<div class="author">
      <div class="author-name">J. Vcelak</div>
<div class="org">NS1</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Verifiable Random Functions (VRFs)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
        A Verifiable Random Function (VRF) is the public-key version of a
        keyed cryptographic hash. Only the holder of the private key
        can compute the hash, but anyone with the public key
        can verify the correctness of the hash.    
        VRFs are useful for preventing enumeration of hash-based data structures.
        This document specifies several VRF constructions based on RSA and Elliptic Curves that are secure in
        the cryptographic random oracle model.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 8 August 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-rationale" class="xref">Rationale</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-requirements" class="xref">Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-vrf-algorithms" class="xref">VRF Algorithms</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-vrf-security-properties" class="xref">VRF Security Properties</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-full-uniqueness-or-trusted-" class="xref">Full Uniqueness or Trusted Uniqueness</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-full-collison-resistance-or" class="xref">Full Collison Resistance or Trusted Collision Resistance</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-full-pseudorandomness-or-se" class="xref">Full Pseudorandomness or Selective Pseudorandomness</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-some-vrfs-unpredictability-" class="xref">Some VRFs: Unpredictability Under Malicious Key Generation</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-rsa-full-domain-hash-vrf-rs" class="xref">RSA Full Domain Hash VRF (RSA-FDH-VRF)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-rsa-fdh-vrf-proving" class="xref">RSA-FDH-VRF Proving</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-rsa-fdh-vrf-proof-to-hash" class="xref">RSA-FDH-VRF Proof to Hash</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-rsa-fdh-vrf-verifying" class="xref">RSA-FDH-VRF Verifying</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-rsa-fdh-vrf-ciphersuites" class="xref">RSA-FDH-VRF Ciphersuites</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-elliptic-curve-vrf-ecvrf" class="xref">Elliptic Curve VRF (ECVRF)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-ecvrf-proving" class="xref">ECVRF Proving</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-ecvrf-proof-to-hash" class="xref">ECVRF Proof to Hash</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-ecvrf-verifying" class="xref">ECVRF Verifying</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-ecvrf-auxiliary-functions" class="xref">ECVRF Auxiliary Functions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.1">
                    <p id="section-toc.1-1.5.2.4.2.1.1"><a href="#section-5.4.1" class="xref">5.4.1</a>.  <a href="#name-ecvrf-encode-to-curve" class="xref">ECVRF Encode to Curve</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.2">
                    <p id="section-toc.1-1.5.2.4.2.2.1"><a href="#section-5.4.2" class="xref">5.4.2</a>.  <a href="#name-ecvrf-nonce-generation" class="xref">ECVRF Nonce Generation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.3">
                    <p id="section-toc.1-1.5.2.4.2.3.1"><a href="#section-5.4.3" class="xref">5.4.3</a>.  <a href="#name-ecvrf-challenge-generation" class="xref">ECVRF Challenge Generation</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.4">
                    <p id="section-toc.1-1.5.2.4.2.4.1"><a href="#section-5.4.4" class="xref">5.4.4</a>.  <a href="#name-ecvrf-decode-proof" class="xref">ECVRF Decode Proof</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.5">
                    <p id="section-toc.1-1.5.2.4.2.5.1"><a href="#section-5.4.5" class="xref">5.4.5</a>.  <a href="#name-ecvrf-validate-key" class="xref">ECVRF Validate Key</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-ecvrf-ciphersuites" class="xref">ECVRF Ciphersuites</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-implementation-status" class="xref">Implementation Status</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-key-generation" class="xref">Key Generation</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.1">
                    <p id="section-toc.1-1.7.2.1.2.1.1"><a href="#section-7.1.1" class="xref">7.1.1</a>.  <a href="#name-uniqueness-and-collision-re" class="xref">Uniqueness and collision resistance with untrusted keys</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1.2.2">
                    <p id="section-toc.1-1.7.2.1.2.2.1"><a href="#section-7.1.2" class="xref">7.1.2</a>.  <a href="#name-pseudorandomness-with-untru" class="xref">Pseudorandomness with untrusted keys</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-security-levels" class="xref">Security Levels</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-selective-vs-full-pseudoran" class="xref">Selective vs. Full Pseudorandomness</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-proper-pseudorandom-nonce-f" class="xref">Proper pseudorandom nonce for ECVRF</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="xref">7.5</a>.  <a href="#name-side-channel-attacks" class="xref">Side-channel attacks</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="xref">7.6</a>.  <a href="#name-proofs-provide-no-secrecy-f" class="xref">Proofs provide no secrecy for the VRF input</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="xref">7.7</a>.  <a href="#name-prehashing" class="xref">Prehashing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.8">
                <p id="section-toc.1-1.7.2.8.1"><a href="#section-7.8" class="xref">7.8</a>.  <a href="#name-hash-function-domain-separa" class="xref">Hash function domain separation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.9">
                <p id="section-toc.1-1.7.2.9.1"><a href="#section-7.9" class="xref">7.9</a>.  <a href="#name-hash-function-salting" class="xref">Hash function salting</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.10">
                <p id="section-toc.1-1.7.2.10.1"><a href="#section-7.10" class="xref">7.10</a>. <a href="#name-futureproofing" class="xref">Futureproofing</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-change-log" class="xref">Change Log</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-contributors" class="xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-test-vectors-for-the-ecvrfs" class="xref">Test Vectors for the ECVRFs</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.  <a href="#name-ecvrf-p256-sha256-tai" class="xref">ECVRF-P256-SHA256-TAI</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#appendix-A.2" class="xref">A.2</a>.  <a href="#name-ecvrf-p256-sha256-sswu" class="xref">ECVRF-P256-SHA256-SSWU</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#appendix-A.3" class="xref">A.3</a>.  <a href="#name-ecvrf-edwards25519-sha512-t" class="xref">ECVRF-EDWARDS25519-SHA512-TAI</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#appendix-A.4" class="xref">A.4</a>.  <a href="#name-ecvrf-edwards25519-sha512-e" class="xref">ECVRF-EDWARDS25519-SHA512-ELL2</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-B" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<section id="section-1.1">
        <h3 id="name-rationale">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-rationale" class="section-name selfRef">Rationale</a>
        </h3>
<p id="section-1.1-1">
   A Verifiable Random Function
   (VRF) <span>[<a href="#MRV99" class="xref">MRV99</a>]</span> is the public-key version of a
   keyed cryptographic hash. Only the holder of the private VRF key
   can compute the hash, but anyone with the corresponding public key
   can verify the correctness of the hash.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">
   A key application of the VRF is to provide privacy against 
   offline dictionary attacks (also known as enumeration attacks) on data stored in a
   hash-based data structure. 
   In this application, a Prover holds the VRF private key and uses the VRF hashing to
   construct a hash-based data structure on the input data.

   Due to the nature of the VRF, only the Prover can answer queries
   about whether or not some data is stored in the data structure.  Anyone who
   knows the public VRF key can verify that the Prover has answered the queries
   correctly. However, no offline inferences (i.e. inferences without querying
   the Prover) can be made about the data stored in the data structure.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
</section>
<section id="section-1.2">
        <h3 id="name-requirements">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-requirements" class="section-name selfRef">Requirements</a>
        </h3>
<p id="section-1.2-1">
                The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
                "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
                document are to be interpreted as described in
                <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
</section>
<section id="section-1.3">
        <h3 id="name-terminology">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.3-1">
                The following terminology is used through this document:<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.3-2">
          <dt id="section-1.3-2.1">SK:</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-2.2">
                        The private key for the VRF.<a href="#section-1.3-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.3">PK:</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-2.4">
                        The public key for the VRF.<a href="#section-1.3-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.5">alpha or alpha_string:</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-2.6">
                        The input to be hashed by the VRF.<a href="#section-1.3-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.7">beta or beta_string:</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-2.8">
                        The VRF hash output.<a href="#section-1.3-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.9">pi or pi_string:</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-2.10">
                        The VRF proof.<a href="#section-1.3-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.11">Prover:</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-2.12">
                        The Prover holds the private VRF key SK and public VRF key PK.<a href="#section-1.3-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-2.13">Verifier:</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-2.14">
                        The Verifier holds the public VRF key PK.<a href="#section-1.3-2.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</section>
</div>
<section id="section-2">
      <h2 id="name-vrf-algorithms">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-vrf-algorithms" class="section-name selfRef">VRF Algorithms</a>
      </h2>
<p id="section-2-1">
   A VRF comes with a key generation algorithm that generates a public VRF 
   key PK and private VRF key SK.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">
   The prover hashes an input alpha using the private VRF key SK to obtain a VRF
   hash output beta<a href="#section-2-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-3.1"> beta = VRF_hash(SK, alpha)<a href="#section-2-3.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-4">
   The VRF_hash algorithm is deterministic, in 
   the sense that it always produces the same output beta given the same
   pair of inputs (SK, alpha).
      
   The prover also uses the private key SK to construct a
   proof pi that beta is the correct hash output<a href="#section-2-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-5.1">pi = VRF_prove(SK, alpha)<a href="#section-2-5.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-6">
   The VRFs defined in this document allow anyone to deterministically
   obtain the VRF hash output beta directly from the proof value pi by using
   the function VRF_proof_to_hash:<a href="#section-2-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-7.1"> beta = VRF_proof_to_hash(pi)<a href="#section-2-7.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-8">
   Thus, for VRFs defined in this document, VRF_hash is defined as<a href="#section-2-8" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-9.1"> VRF_hash(SK, alpha) = VRF_proof_to_hash(VRF_prove(SK, alpha)),<a href="#section-2-9.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-10">
   and therefore this document will specify VRF_prove and VRF_proof_to_hash
   rather than VRF_hash.<a href="#section-2-10" class="pilcrow">¶</a></p>
<p id="section-2-11">
   The proof pi allows a Verifier holding the public key PK
   to verify that beta is the correct VRF hash of input alpha
   under key PK. Thus, the VRFs defined in this document also come with an algorithm<a href="#section-2-11" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2-12.1">   VRF_verify(PK, alpha, pi)<a href="#section-2-12.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-13">
   that outputs (VALID, beta = VRF_proof_to_hash(pi)) if pi is valid,
   and INVALID otherwise.<a href="#section-2-13" class="pilcrow">¶</a></p>
</section>
<div id="secdef">
<section id="section-3">
      <h2 id="name-vrf-security-properties">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-vrf-security-properties" class="section-name selfRef">VRF Security Properties</a>
      </h2>
<p id="section-3-1"> VRFs are designed to ensure the following security properties.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="uniqueness">
<section id="section-3.1">
        <h3 id="name-full-uniqueness-or-trusted-">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-full-uniqueness-or-trusted-" class="section-name selfRef">Full Uniqueness or Trusted Uniqueness</a>
        </h3>
<p id="section-3.1-1"> Uniqueness means that, for any fixed public
 VRF key and for any input alpha, there is a unique VRF
 output beta that can be proved to be valid.  Uniqueness must hold
    even for an adversarial Prover that knows the VRF private key SK.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">
    More precisely, "full uniqueness" states that a computationally-bounded adversary cannot
 choose 
    a VRF public key PK, 
    a VRF input alpha, 
    and two proofs pi1 and pi2 such that
    VRF_verify(PK, alpha, pi1) outputs (VALID, beta1),
    VRF_verify(PK, alpha, pi2) outputs (VALID, beta2),
    and beta1 is not equal to beta2.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">
     For many applications, a slightly weaker security
     property called "trusted uniqueness" suffices.
     Trusted uniqueness is the same as full uniqueness, but it is guaranteed to hold
     only if the VRF keys PK and SK were generated in a trustworthy 
     manner.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">
        As further discussed in <a href="#untrustedkeys" class="xref">Section 7.1.1</a>,
        some VRFs specified in this document satisfy only trusted uniqueness, while others satisfy full uniqueness.
        VRFs in this document that satisfy only trusted uniqueness but not full uniqueness MUST NOT be used if the key generation
        process cannot be trusted.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="collisionresistance">
<section id="section-3.2">
        <h3 id="name-full-collison-resistance-or">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-full-collison-resistance-or" class="section-name selfRef">Full Collison Resistance or Trusted Collision Resistance</a>
        </h3>
<p id="section-3.2-1">Like any cryptographic hash function, VRFs need to be
        collision resistant.  Collison resistance must hold
    even for an adversarial Prover that knows the VRF private key SK.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2"> More precisely, "full collision resistance" states that
        it should be computationally 
        infeasible for an adversary to find two distinct VRF
     inputs alpha1 and alpha2 that have the same VRF hash beta, 
        even if that adversary knows the private VRF key SK.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">
     For many applications, a slightly weaker security property
        called "trusted collision resistance" suffices. 
        Trusted collision resistance is the same as collision resistance, 
        but it is guaranteed to hold only if the VRF keys PK and SK were generated in a trustworthy manner.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">
        As further discussed in <a href="#untrustedkeys" class="xref">Section 7.1.1</a>,
        some VRFs specified in this document satisfy only trusted collision resistance, while others satisfy full collision resistance.
        VRFs in this document that satisfy only trusted collision resistance but not full collision resistance MUST NOT be used if the key generation
        process cannot be trusted.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="pseudodef">
<section id="section-3.3">
        <h3 id="name-full-pseudorandomness-or-se">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-full-pseudorandomness-or-se" class="section-name selfRef">Full Pseudorandomness or Selective Pseudorandomness</a>
        </h3>
<p id="section-3.3-1"> Pseudorandomness ensures that when an adversarial Verifier sees 
        a VRF hash output beta without its corresponding VRF proof pi, 
        then beta is indistinguishable from a random value.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">  More precisely, suppose the public and private VRF keys (PK, SK) were generated
      in a trustworthy manner.
      Pseudorandomness ensures that the VRF hash output beta
         (without its corresponding VRF proof pi) on
      any adversarially-chosen "target" VRF input alpha
      looks indistinguishable from random
      for any computationally bounded adversary who does not know the private
         VRF key SK.  This holds even if the adversary also gets to 
         choose other VRF inputs alpha' and observe their corresponding 
         VRF hash outputs beta' and proofs pi'.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">   
         With "full pseudorandomness", the adversary is allowed to choose the 
         "target" VRF input  alpha at any time, even after it observes VRF outputs beta'
         and proofs pi' on a variety of chosen inputs alpha'.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">
         "Selective pseudorandomness" is a weaker security property
         which suffices in many applications. Here, the adversary must choose
         the target VRF input alpha independently of the public VRF key PK,
         and before it  observes VRF outputs beta'
         and proofs pi' on inputs alpha' of its choice.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">
             As further discussed in <a href="#prsecurity" class="xref">Section 7.3</a>,
             VRFs specified in this document satisfy both full pseudorandomness and selective pseudorandomness,
             but their quantitative security against the selective pseudorandomness attack is stronger.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<p id="section-3.3-6"> 
    It is important to remember that the VRF output beta does not 
    look random to the Prover, or to any other party that knows the private 
       VRF key SK!  Such a party can easily distinguish beta from 
       a random value by comparing beta to the result of VRF_hash(SK, alpha).<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<p id="section-3.3-7"> Also, the VRF output beta does not look random to any party that
 knows a valid VRF proof pi corresponding to the VRF input alpha, even
 if this party does not know the private VRF key SK.
 Such a party can easily distinguish beta from a random value by
    checking whether VRF_verify(PK, alpha, pi) returns (VALID, beta).<a href="#section-3.3-7" class="pilcrow">¶</a></p>
<p id="section-3.3-8">
    Also, the VRF output beta may not look random if VRF key generation
    was not done in a trustworthy fashion. (For example, if VRF keys were 
    generated with bad randomness.)<a href="#section-3.3-8" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-3.4">
        <h3 id="name-some-vrfs-unpredictability-">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-some-vrfs-unpredictability-" class="section-name selfRef">Some VRFs: Unpredictability Under Malicious Key Generation</a>
        </h3>
<p id="section-3.4-1">As explained in <a href="#pseudodef" class="xref">Section 3.3</a>, pseudorandomness is guaranteed only
       if the VRF keys were generated in a trustworthy fashion.
       For instance, if an adversary outputs VRF keys that are deterministically generated (or hard-coded and publicly known), then the outputs are easily derived by anyone and are therefore not pseudorandom.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">There is, however, a different type of unpredictability that is desirable in certain VRF applications (such as leader selection in the consensus protocols of <span>[<a href="#GHMVZ17" class="xref">GHMVZ17</a>]</span> and <span>[<a href="#DGKR18" class="xref">DGKR18</a>]</span>), called "unpredictability under malicious key generation". This property is similar
       to the unpredictability achieved by an (ordinary, unkeyed)
       cryptographic hash function: if the input has enough entropy (i.e., cannot be predicted), then the correct output is indistinguishable
       from uniform, no matter how the VRF keys are generated.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3">
       A formal definition of this property appears in Section 3.2 of <span>[<a href="#DGKR18" class="xref">DGKR18</a>]</span>.  The RSA-FDH-VRF presented in this document does not satisfy this property. The ECVRF presented in this document satisfies this property if validate_key parameter given to the ECVRF_verify is TRUE.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="fdh">
<section id="section-4">
      <h2 id="name-rsa-full-domain-hash-vrf-rs">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-rsa-full-domain-hash-vrf-rs" class="section-name selfRef">RSA Full Domain Hash VRF (RSA-FDH-VRF)</a>
      </h2>
<p id="section-4-1">
            The RSA Full Domain Hash  VRF (RSA-FDH-VRF) is a VRF that, for suitable key lengths, satisfies
            the "trusted uniqueness", "trusted
            collision resistance", and "full pseudorandomness" properties defined in <a href="#secdef" class="xref">Section 3</a>, as further discussed in <a href="#securitycons" class="xref">Section 7</a>.
            Its security follows from the
            standard RSA assumption in the random oracle model.  Formal
            security proofs are in <span>[<a href="#PWHVNRG17" class="xref">PWHVNRG17</a>]</span>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">
            The VRF computes the proof pi as a deterministic RSA signature on
            input alpha using the RSA Full Domain Hash Algorithm
            <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> parametrized with the selected hash algorithm.
            RSA signature verification is used to verify the correctness of the
            proof. The VRF hash output beta is simply obtained by hashing 
            the proof pi with the selected hash algorithm.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">
            The key pair for RSA-FDH-VRF MUST be generated in a way that it satisfies
            the conditions specified in Section 3 of <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span>.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">
            In this section, the notation from <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> is used.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">
            Parameters used:<a href="#section-4-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty"><li class="normal ulEmpty" id="section-4-6.1">(n, e) - RSA public key<a href="#section-4-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-4-6.2">K - RSA private key (its representation is implementation-dependent)<a href="#section-4-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-4-6.3">k - length in octets of the RSA modulus n (k must be less than 2^32)<a href="#section-4-6.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-7">
            Fixed options (specified in <a href="#rsavrfSuites" class="xref">Section 4.4</a>):<a href="#section-4-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4-8.1">Hash - cryptographic hash function<a href="#section-4-8.1" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-4-8.2">hLen - output length in octets of hash function Hash<a href="#section-4-8.2" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-4-8.3">suite_string - an octet string specifying the RSA-FDH-VRF
                ciphersuite, which determines the above options<a href="#section-4-8.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-9">
            Primitives used:<a href="#section-4-9" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4-10.1">
                    I2OSP - Conversion of a nonnegative integer to an octet string as defined in
                    Section 4.1 of <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span>
                    (given an integer and a length in octets, produces a big-endian representation of the integer, zero-padded to the desired length)<a href="#section-4-10.1" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-4-10.2">
                    OS2IP - Conversion of an octet string to a nonnegative integer as defined in
                    Section 4.2 of <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span>
                    (given a big-endian encoding of an integer, produces the integer)<a href="#section-4-10.2" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-4-10.3">
                    RSASP1 - RSA signature primitive as defined in
                    Section 5.2.1 of <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> (given a private key and an input, raises the input to the private RSA exponent modulo n)<a href="#section-4-10.3" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-4-10.4">
                    RSAVP1 - RSA verification primitive as defined in
                    Section 5.2.2 of <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> (given a public key and an input, raises the input to the public RSA exponent modulo n)<a href="#section-4-10.4" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-4-10.5">
                    MGF1 - Mask Generation Function based on the hash function Hash as defined in
                    Section B.2.1 of <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span> (given an input, produces a random-oracle-like output of desired length)<a href="#section-4-10.5" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-4-10.6">
                    || - octet string concatenation<a href="#section-4-10.6" class="pilcrow">¶</a>
</li>
      </ul>
<section id="section-4.1">
        <h3 id="name-rsa-fdh-vrf-proving">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-rsa-fdh-vrf-proving" class="section-name selfRef">RSA-FDH-VRF Proving</a>
        </h3>
<p id="section-4.1-1">
                RSAFDHVRF_prove(K, alpha_string[, MGF_salt])<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">
                Input:<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.1-3.1">K - RSA private key<a href="#section-4.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.1-3.2">alpha_string - VRF hash input, an octet string<a href="#section-4.1-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.1-4">
                Optional Input:<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.1-5.1">MGF_salt - a public octet string used as a hash function salt; this input is not used when MGF_salt is specified as part of the ciphersuite<a href="#section-4.1-5.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.1-6">
                Output:<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.1-7.1">pi_string - proof, an octet string of length k<a href="#section-4.1-7.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.1-8">
                Steps:<a href="#section-4.1-8" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1-9">
<li id="section-4.1-9.1">mgf_domain_separator = 0x01<a href="#section-4.1-9.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-9.2">EM = MGF1(suite_string || mgf_domain_separator || MGF_salt || alpha_string, k - 1)<a href="#section-4.1-9.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-9.3">m = OS2IP(EM)<a href="#section-4.1-9.3" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-9.4">s = RSASP1(K, m)<a href="#section-4.1-9.4" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-9.5">pi_string = I2OSP(s, k)<a href="#section-4.1-9.5" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-9.6">Output pi_string<a href="#section-4.1-9.6" class="pilcrow">¶</a>
</li>
        </ol>
</section>
<section id="section-4.2">
        <h3 id="name-rsa-fdh-vrf-proof-to-hash">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-rsa-fdh-vrf-proof-to-hash" class="section-name selfRef">RSA-FDH-VRF Proof to Hash</a>
        </h3>
<p id="section-4.2-1">
                RSAFDHVRF_proof_to_hash(pi_string)<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">
                Input:<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2-3.1">pi_string - proof, an octet string of length k<a href="#section-4.2-3.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.2-4">
                Output:<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2-5.1">beta_string - VRF hash output, an octet string of length hLen<a href="#section-4.2-5.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.2-6">
                Important note:<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.2-7.1">RSAFDHVRF_proof_to_hash should be run only on pi_string that is known to have been produced by RSAFDHVRF_prove, or from within RSAFDHVRF_verify as specified in <a href="#rsaverify" class="xref">Section 4.3</a>.<a href="#section-4.2-7.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.2-8">
                Steps:<a href="#section-4.2-8" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2-9">
<li id="section-4.2-9.1">proof_to_hash_domain_separator = 0x02<a href="#section-4.2-9.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.2-9.2">beta_string = Hash(suite_string || proof_to_hash_domain_separator || pi_string)<a href="#section-4.2-9.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.2-9.3">Output beta_string<a href="#section-4.2-9.3" class="pilcrow">¶</a>
</li>
        </ol>
</section>
<div id="rsaverify">
<section id="section-4.3">
        <h3 id="name-rsa-fdh-vrf-verifying">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-rsa-fdh-vrf-verifying" class="section-name selfRef">RSA-FDH-VRF Verifying</a>
        </h3>
<p id="section-4.3-1">
                RSAFDHVRF_verify((n, e), alpha_string, pi_string[, MGF_salt])<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">
                Input:<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.3-3.1">(n, e) - RSA public key<a href="#section-4.3-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.3-3.2">alpha_string - VRF hash input, an octet string<a href="#section-4.3-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-4.3-3.3">pi_string - proof to be verified, an octet string of length k<a href="#section-4.3-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.3-4">
                Optional Input:<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.3-5.1">MGF_salt - a public octet string used as a hash function salt; this input is not used when MGF_salt is specified as part of the ciphersuite<a href="#section-4.3-5.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.3-6">
                Output:<a href="#section-4.3-6" class="pilcrow">¶</a></p>
<p id="section-4.3-7">
                Output:<a href="#section-4.3-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-4.3-8.1">
            <p id="section-4.3-8.1.1">("VALID", beta_string), where beta_string is the VRF hash output, an octet string of length hLen; or<a href="#section-4.3-8.1.1" class="pilcrow">¶</a></p>
<p id="section-4.3-8.1.2">"INVALID"<a href="#section-4.3-8.1.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-4.3-9">
                Steps:<a href="#section-4.3-9" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3-10">
<li id="section-4.3-10.1">s = OS2IP(pi_string)<a href="#section-4.3-10.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-10.2">m = RSAVP1((n, e), s); if RSAVP1 returns "signature representative out of range", output "INVALID" and stop.<a href="#section-4.3-10.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-10.3">mgf_domain_separator = 0x01<a href="#section-4.3-10.3" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-10.4">EM' = MGF1(suite_string || mgf_domain_separator || MGF_salt ||  alpha_string, k - 1)<a href="#section-4.3-10.4" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-10.5">m' = OS2IP(EM')<a href="#section-4.3-10.5" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-10.6">
                        If m and m' are equal, output ("VALID", RSAFDHVRF_proof_to_hash(pi_string));
                        else output "INVALID".<a href="#section-4.3-10.6" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="rsavrfSuites">
<section id="section-4.4">
        <h3 id="name-rsa-fdh-vrf-ciphersuites">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-rsa-fdh-vrf-ciphersuites" class="section-name selfRef">RSA-FDH-VRF Ciphersuites</a>
        </h3>
<p id="section-4.4-1">This document defines RSA-FDH-VRF-SHA256 as follows:<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-2.1">suite_string = 0x01<a href="#section-4.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-2.2">The hash function Hash is SHA-256 as specified in <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>, with hLen = 32<a href="#section-4.4-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-2.3">MGF_salt = I2OSP(k, 4) || I2OSP(n, k)<a href="#section-4.4-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.4-3">This document defines RSA-FDH-VRF-SHA384 as follows:<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-4.1">suite_string = 0x02<a href="#section-4.4-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-4.2">The hash function Hash is SHA-384 as specified in <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>, with hLen = 48<a href="#section-4.4-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-4.3">MGF_salt = I2OSP(k, 4) || I2OSP(n, k)<a href="#section-4.4-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.4-5">This document defines RSA-FDH-VRF-SHA512 as follows:<a href="#section-4.4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.4-6.1">suite_string = 0x03<a href="#section-4.4-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-6.2">The hash function Hash is SHA-512 as specified in <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>, with hLen = 64<a href="#section-4.4-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.4-6.3">MGF_salt = I2OSP(k, 4) || I2OSP(n, k)<a href="#section-4.4-6.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="ecvrf">
<section id="section-5">
      <h2 id="name-elliptic-curve-vrf-ecvrf">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-elliptic-curve-vrf-ecvrf" class="section-name selfRef">Elliptic Curve VRF (ECVRF)</a>
      </h2>
<p id="section-5-1">
            The Elliptic Curve Verifiable Random Function (ECVRF) is a VRF that, for suitable parameter choices,
            satisfies the "full uniqueness", "trusted collision resistance",
            and "full pseudorandomness properties" defined in <a href="#secdef" class="xref">Section 3</a>.
            If validate_key parameter given to the ECVRF_verify is TRUE, then
            the ECVRF additionally satisfies "full collision resistance" and "unpredictability under malicious key generation". See <a href="#securitycons" class="xref">Section 7</a>
            for further discussion. Formal security proofs are
            in <span>[<a href="#PWHVNRG17" class="xref">PWHVNRG17</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">
            Notation used:<a href="#section-5-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5-3.1">Elliptic curve operations are written in additive notation, with P+Q denoting point addition and x*P denoting scalar multiplication of a point P by a scalar x<a href="#section-5-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-3.2">x^y - x raised to the power y<a href="#section-5-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-3.3">x*y - x multiplied by y<a href="#section-5-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-3.4">s || t - concatenation of octet strings s and t<a href="#section-5-3.4" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-3.5">0xMN (where M and N are hexadecimal digits) - a single octet with value M*16+N; equivalently, int_to_string(M*16+N, 1), where int_to_string is as defined below.<a href="#section-5-3.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-5-4">
            Fixed options (specified in <a href="#ecvrfSuites" class="xref">Section 5.5</a>):<a href="#section-5-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5-5.1">F - finite field<a href="#section-5-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-5.2">fLen - length, in octets, of an element in F encoded as an octet string<a href="#section-5-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-5.3">E - elliptic curve (EC) defined over F<a href="#section-5-5.3" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-5.4">ptLen - length, in octets, of a point on E encoded as an octet string<a href="#section-5-5.4" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-5.5">G - subgroup of E of large prime order<a href="#section-5-5.5" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-5.6">q - prime order of group G<a href="#section-5-5.6" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-5.7">qLen - length of q in octets, i.e., smallest integer such that 2^(8qLen)&gt;q<a href="#section-5-5.7" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-5.8">cLen - length, in octets, of a challenge value used by the VRF (note that in the typical case, cLen is qLen/2 or close to it)<a href="#section-5-5.8" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-5.9">cofactor - number of points on E divided by q<a href="#section-5-5.9" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-5.10">B - generator of group G<a href="#section-5-5.10" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-5.11">Hash - cryptographic hash function<a href="#section-5-5.11" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-5.12">hLen - output length in octets of Hash (hLen must be at least cLen; in the typical case, it is at least qLen)<a href="#section-5-5.12" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-5.13">ECVRF_encode_to_curve - a function that hashes strings to points on E.<a href="#section-5-5.13" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-5.14">ECVRF_nonce_generation - a function that derives a pseudorandom nonce
                    from SK and the input as part of ECVRF proving.<a href="#section-5-5.14" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-5.15">suite_string - an octet string specifying the ECVRF
                ciphersuite, which determines the above options as well as type conversions and parameter generation<a href="#section-5-5.15" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-5-6">
            Type conversions (specified in <a href="#ecvrfSuites" class="xref">Section 5.5</a>):<a href="#section-5-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5-7.1">int_to_string(a, len) - conversion of nonnegative integer a
                    to octet string of length len<a href="#section-5-7.1" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-7.2"> string_to_int(a_string) - conversion of an octet string a_string
                    to a nonnegative integer<a href="#section-5-7.2" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-7.3">point_to_string - conversion of a point on E to an ptLen-octet string<a href="#section-5-7.3" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-7.4">string_to_point - conversion of an ptLen-octet string to a point on E.
                    string_to_point returns INVALID if the octet string does not convert to a valid EC point on the curve E.<a href="#section-5-7.4" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-7.5">
                    Note that with certain software libraries
                    (for big integer and elliptic curve arithmetic),
                    the int_to_string and point_to_string conversions are not needed, when
                    the libraries encode integers and EC points in the same way as required
                    by the ciphersuites.
                    For example, in some implementations, EC point
                    operations will take octet strings as inputs and
                    produce octet strings as outputs, without introducing
                    a separate elliptic curve point type.<a href="#section-5-7.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-5-8">
            Parameters used (the generation of these parameters is specified in <a href="#ecvrfSuites" class="xref">Section 5.5</a>):<a href="#section-5-8" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5-9.1">SK - VRF private key<a href="#section-5-9.1" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-9.2">x - VRF secret scalar, an integer.
                        Note: depending on the ciphersuite used, the VRF secret scalar may be equal
                        to SK; else, it is derived from SK<a href="#section-5-9.2" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-9.3">Y = x*B - VRF public key, an point on E<a href="#section-5-9.3" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-9.4">PK_string = point_to_string(Y) - VRF public key represented as an octet string<a href="#section-5-9.4" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-5-9.5">encode_to_curve_salt - a public value used as a hash function salt<a href="#section-5-9.5" class="pilcrow">¶</a>
</li>
      </ul>
<div id="ecvrfprove">
<section id="section-5.1">
        <h3 id="name-ecvrf-proving">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-ecvrf-proving" class="section-name selfRef">ECVRF Proving</a>
        </h3>
<p id="section-5.1-1">
                ECVRF_prove(SK, alpha_string[, encode_to_curve_salt])<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">
                Input:<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.1-3.1">SK - VRF private key<a href="#section-5.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-5.1-3.2">alpha_string - input alpha, an octet string<a href="#section-5.1-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-4">
                Optional input:<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.1-5.1">encode_to_curve_salt - a public salt value, an octet string; this input is not used when encode_to_curve_salt is specified as part of the ciphersuite<a href="#section-5.1-5.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-6">
                Output:<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.1-7.1">pi_string - VRF proof, octet string of length ptLen+cLen+qLen<a href="#section-5.1-7.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.1-8">
                Steps:<a href="#section-5.1-8" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.1-9">
<li id="section-5.1-9.1">
            <p id="section-5.1-9.1.1">Use SK to derive the VRF secret scalar x and the VRF public key Y = x*B<a href="#section-5.1-9.1.1" class="pilcrow">¶</a></p>
<p id="section-5.1-9.1.2">(this derivation depends on the ciphersuite, as per  <a href="#ecvrfSuites" class="xref">Section 5.5</a>;<a href="#section-5.1-9.1.2" class="pilcrow">¶</a></p>
<p id="section-5.1-9.1.3">these values can be cached, for example, after key generation, and need not be rederived each time)<a href="#section-5.1-9.1.3" class="pilcrow">¶</a></p>
</li>
          <li id="section-5.1-9.2">H = ECVRF_encode_to_curve(encode_to_curve_salt, alpha_string) (see <a href="#ecvrfH2C" class="xref">Section 5.4.1</a>)<a href="#section-5.1-9.2" class="pilcrow">¶</a>
</li>
          <li id="section-5.1-9.3">h_string = point_to_string(H)<a href="#section-5.1-9.3" class="pilcrow">¶</a>
</li>
          <li id="section-5.1-9.4">Gamma = x*H<a href="#section-5.1-9.4" class="pilcrow">¶</a>
</li>
          <li id="section-5.1-9.5">k = ECVRF_nonce_generation(SK, h_string) (see <a href="#ecvrfNonceGeneration" class="xref">Section 5.4.2</a>)<a href="#section-5.1-9.5" class="pilcrow">¶</a>
</li>
          <li id="section-5.1-9.6">c = ECVRF_challenge_generation(Y, H, Gamma, k*B, k*H) (see <a href="#ecvrfChallengeGeneration" class="xref">Section 5.4.3</a>)<a href="#section-5.1-9.6" class="pilcrow">¶</a>
</li>
          <li id="section-5.1-9.7">s = (k + c*x) mod q<a href="#section-5.1-9.7" class="pilcrow">¶</a>
</li>
          <li id="section-5.1-9.8">pi_string = point_to_string(Gamma) || int_to_string(c, cLen) || int_to_string(s, qLen)<a href="#section-5.1-9.8" class="pilcrow">¶</a>
</li>
          <li id="section-5.1-9.9">Output pi_string<a href="#section-5.1-9.9" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<section id="section-5.2">
        <h3 id="name-ecvrf-proof-to-hash">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-ecvrf-proof-to-hash" class="section-name selfRef">ECVRF Proof to Hash</a>
        </h3>
<p id="section-5.2-1">
                ECVRF_proof_to_hash(pi_string)<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">
                Input:<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.2-3.1">pi_string - VRF proof, octet string of length ptLen+cLen+qLen<a href="#section-5.2-3.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.2-4">
                Output:<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.2-5.1">"INVALID", or<a href="#section-5.2-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-5.2-5.2">beta_string - VRF hash output, octet string of length hLen<a href="#section-5.2-5.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.2-6">
                Important note:<a href="#section-5.2-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.2-7.1">ECVRF_proof_to_hash should be run only on pi_string that is known to have been produced by ECVRF_prove, or
                        from within ECVRF_verify as specified in <a href="#ecverify" class="xref">Section 5.3</a>.<a href="#section-5.2-7.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.2-8">
                Steps:<a href="#section-5.2-8" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2-9">
<li id="section-5.2-9.1">D = ECVRF_decode_proof(pi_string) (see <a href="#ecvrfDecodeProof" class="xref">Section 5.4.4</a>)<a href="#section-5.2-9.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.2-9.2">If D is "INVALID", output "INVALID" and stop<a href="#section-5.2-9.2" class="pilcrow">¶</a>
</li>
          <li id="section-5.2-9.3">(Gamma, c, s) = D<a href="#section-5.2-9.3" class="pilcrow">¶</a>
</li>
          <li id="section-5.2-9.4">proof_to_hash_domain_separator_front = 0x03<a href="#section-5.2-9.4" class="pilcrow">¶</a>
</li>
          <li id="section-5.2-9.5">proof_to_hash_domain_separator_back = 0x00<a href="#section-5.2-9.5" class="pilcrow">¶</a>
</li>
          <li id="section-5.2-9.6">beta_string = Hash(suite_string || proof_to_hash_domain_separator_front || point_to_string(cofactor * Gamma) || proof_to_hash_domain_separator_back)<a href="#section-5.2-9.6" class="pilcrow">¶</a>
</li>
          <li id="section-5.2-9.7">Output beta_string<a href="#section-5.2-9.7" class="pilcrow">¶</a>
</li>
        </ol>
</section>
<div id="ecverify">
<section id="section-5.3">
        <h3 id="name-ecvrf-verifying">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-ecvrf-verifying" class="section-name selfRef">ECVRF Verifying</a>
        </h3>
<p id="section-5.3-1">
                ECVRF_verify(PK_string, alpha_string, pi_string[, encode_to_curve_salt, validate_key])<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">
                Input:<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.3-3.1">PK_string - public key, an octet string<a href="#section-5.3-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-5.3-3.2">alpha_string - VRF input, octet string<a href="#section-5.3-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-5.3-3.3">pi_string - VRF proof, octet string of length ptLen+cLen+qLen<a href="#section-5.3-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.3-4">
                Optional input:<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.3-5.1">encode_to_curve_salt - a public salt value, an octet string; this input is not used when encode_to_curve_salt is specified as part of the ciphersuite<a href="#section-5.3-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-5.3-5.2">validate_key - a boolean. An implementation MAY support only the option of validate_key = TRUE, or only the option of validate_key = FALSE, in which case this input is not needed. If an implementation supports only one option, it MUST specify which option is supports.<a href="#section-5.3-5.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.3-6">
                Output:<a href="#section-5.3-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.3-7.1">
            <p id="section-5.3-7.1.1">("VALID", beta_string), where beta_string is the VRF hash output, octet string of length hLen; or<a href="#section-5.3-7.1.1" class="pilcrow">¶</a></p>
<p id="section-5.3-7.1.2"> "INVALID"<a href="#section-5.3-7.1.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.3-8">
                Steps:<a href="#section-5.3-8" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.3-9">
          <li id="section-5.3-9.1">Y =  string_to_point(PK_string)<a href="#section-5.3-9.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-9.2">If Y is "INVALID", output "INVALID" and stop<a href="#section-5.3-9.2" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-9.3">If validate_key, run ECVRF_validate_key(Y) (<a href="#keycheck" class="xref">Section 5.4.5</a>); if it outputs "INVALID", output "INVALID" and stop<a href="#section-5.3-9.3" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-9.4">D = ECVRF_decode_proof(pi_string) (see <a href="#ecvrfDecodeProof" class="xref">Section 5.4.4</a>)<a href="#section-5.3-9.4" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-9.5">If D is "INVALID", output "INVALID" and stop<a href="#section-5.3-9.5" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-9.6">(Gamma, c, s) = D<a href="#section-5.3-9.6" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-9.7">H = ECVRF_encode_to_curve(encode_to_curve_salt, alpha_string) (see <a href="#ecvrfH2C" class="xref">Section 5.4.1</a>)<a href="#section-5.3-9.7" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-9.8">U = s*B - c*Y<a href="#section-5.3-9.8" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-9.9">V = s*H - c*Gamma<a href="#section-5.3-9.9" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-9.10">c' = ECVRF_challenge_generation(Y, H, Gamma, U, V) (see <a href="#ecvrfChallengeGeneration" class="xref">Section 5.4.3</a>)<a href="#section-5.3-9.10" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-9.11">
                        If c and c' are equal, output ("VALID", ECVRF_proof_to_hash(pi_string));
                        else output "INVALID"<a href="#section-5.3-9.11" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-5.3-10">Note that the first three steps need to be performed only once for a given public key.<a href="#section-5.3-10" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-5.4">
        <h3 id="name-ecvrf-auxiliary-functions">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-ecvrf-auxiliary-functions" class="section-name selfRef">ECVRF Auxiliary Functions</a>
        </h3>
<div id="ecvrfH2C">
<section id="section-5.4.1">
          <h4 id="name-ecvrf-encode-to-curve">
<a href="#section-5.4.1" class="section-number selfRef">5.4.1. </a><a href="#name-ecvrf-encode-to-curve" class="section-name selfRef">ECVRF Encode to Curve</a>
          </h4>
<p id="section-5.4.1-1">The ECVRF_encode_to_curve algorithm takes a public salt (see <a href="#salt" class="xref">Section 7.9</a>) and the VRF input alpha
            and converts it to H, an EC point in G.
            This algorithm is the only place the VRF input alpha is used
            for proving and verifying. See
            <a href="#prehash" class="xref">Section 7.7</a> for further discussion.<a href="#section-5.4.1-1" class="pilcrow">¶</a></p>
<p id="section-5.4.1-2">This section specifies a number of such algorithms, which are not compatible with each other and are intended to use with various ciphersuites specified in <a href="#ecvrfSuites" class="xref">Section 5.5</a>.<a href="#section-5.4.1-2" class="pilcrow">¶</a></p>
<p id="section-5.4.1-3">
                Input:<a href="#section-5.4.1-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4.1-4.1">encode_to_curve_salt - public salt value, an octet string<a href="#section-5.4.1-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-5.4.1-4.2">alpha_string - value to be hashed, an octet string<a href="#section-5.4.1-4.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.4.1-5">
               Output:<a href="#section-5.4.1-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4.1-6.1">H - hashed value, a point in G<a href="#section-5.4.1-6.1" class="pilcrow">¶</a>
</li>
          </ul>
<div id="ecvrfH2C1">
<section id="section-5.4.1.1">
            <h5 id="name-ecvrf_encode_to_curve_try_a">
<a href="#section-5.4.1.1" class="section-number selfRef">5.4.1.1. </a><a href="#name-ecvrf_encode_to_curve_try_a" class="section-name selfRef">ECVRF_encode_to_curve_try_and_increment</a>
            </h5>
<p id="section-5.4.1.1-1">
            The following ECVRF_encode_to_curve_try_and_increment(encode_to_curve_salt, alpha_string) algorithm
            implements ECVRF_encode_to_curve in a simple and
            generic way that works for any elliptic curve. To use this algorithm,
            hLen MUST be at least fLen.<a href="#section-5.4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.4.1.1-2">
            The running time of this algorithm depends on alpha_string.
            For the ciphersuites specified 
            in <a href="#ecvrfSuites" class="xref">Section 5.5</a>, this algorithm
            is expected to find a valid curve point after approximately two attempts 
            (i.e., when ctr=1) on average.<a href="#section-5.4.1.1-2" class="pilcrow">¶</a></p>
<p id="section-5.4.1.1-3">
            However, because the running time of algorithm depends on alpha_string,
            this algorithm SHOULD be avoided in 
            applications where it is important that
            the VRF input alpha remain secret.<a href="#section-5.4.1.1-3" class="pilcrow">¶</a></p>
<p id="section-5.4.1.1-4">
                ECVRF_encode_to_curve_try_and_increment(encode_to_curve_salt, alpha_string)<a href="#section-5.4.1.1-4" class="pilcrow">¶</a></p>
<p id="section-5.4.1.1-5">
                Fixed option  (specified in <a href="#ecvrfSuites" class="xref">Section 5.5</a>):<a href="#section-5.4.1.1-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4.1.1-6.1">interpret_hash_value_as_a_point - a function that attempts to convert a cryptographic hash value to a point on E; may output INVALID.<a href="#section-5.4.1.1-6.1" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.4.1.1-7">
                Steps:<a href="#section-5.4.1.1-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.1.1-8">
<li id="section-5.4.1.1-8.1">ctr = 0<a href="#section-5.4.1.1-8.1" class="pilcrow">¶</a>
</li>
              <li id="section-5.4.1.1-8.2">encode_to_curve_domain_separator_front = 0x01<a href="#section-5.4.1.1-8.2" class="pilcrow">¶</a>
</li>
              <li id="section-5.4.1.1-8.3">encode_to_curve_domain_separator_back = 0x00<a href="#section-5.4.1.1-8.3" class="pilcrow">¶</a>
</li>
              <li id="section-5.4.1.1-8.4">H = "INVALID"<a href="#section-5.4.1.1-8.4" class="pilcrow">¶</a>
</li>
              <li id="section-5.4.1.1-8.5">
                <p id="section-5.4.1.1-8.5.1">While H is "INVALID" or H is the identity element of the elliptic curve group:<a href="#section-5.4.1.1-8.5.1" class="pilcrow">¶</a></p>
<ol start="1" type="a" class="normal type-a" id="section-5.4.1.1-8.5.2">
<li id="section-5.4.1.1-8.5.2.1">ctr_string = int_to_string(ctr, 1)<a href="#section-5.4.1.1-8.5.2.1" class="pilcrow">¶</a>
</li>
                  <li id="section-5.4.1.1-8.5.2.2">hash_string = Hash(suite_string || encode_to_curve_domain_separator_front || encode_to_curve_salt || alpha_string || ctr_string || encode_to_curve_domain_separator_back)<a href="#section-5.4.1.1-8.5.2.2" class="pilcrow">¶</a>
</li>
                  <li id="section-5.4.1.1-8.5.2.3">H = interpret_hash_value_as_a_point(hash_string)<a href="#section-5.4.1.1-8.5.2.3" class="pilcrow">¶</a>
</li>
                  <li id="section-5.4.1.1-8.5.2.4">If H is not "INVALID" and cofactor &gt; 1, set H = cofactor * H<a href="#section-5.4.1.1-8.5.2.4" class="pilcrow">¶</a>
</li>
                  <li id="section-5.4.1.1-8.5.2.5">ctr = ctr + 1<a href="#section-5.4.1.1-8.5.2.5" class="pilcrow">¶</a>
</li>
                </ol>
</li>
              <li id="section-5.4.1.1-8.6">Output H<a href="#section-5.4.1.1-8.6" class="pilcrow">¶</a>
</li>
            </ol>
<p id="section-5.4.1.1-9">
            Note even though the loop is infinite as written, and int_to_string(ctr,1) may fail when ctr reaches 256,
            interpret_hash_value_as_a_point functions specified in <a href="#ecvrfSuites" class="xref">Section 5.5</a>
            will succeed on roughly half hash_string values. Thus the loop is expected to stop after two iterations, and ctr is overwhelmingly unlikely (probability about 2^-256) to reach 256.<a href="#section-5.4.1.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="h2csuite">
<section id="section-5.4.1.2">
            <h5 id="name-ecvrf_encode_to_curve_h2c_s">
<a href="#section-5.4.1.2" class="section-number selfRef">5.4.1.2. </a><a href="#name-ecvrf_encode_to_curve_h2c_s" class="section-name selfRef">ECVRF_encode_to_curve_h2c_suite</a>
            </h5>
<p id="section-5.4.1.2-1">The ECVRF_encode_to_curve_h2c_suite(encode_to_curve_salt, alpha_string) algorithm
                implements ECVRF_encode_to_curve using one of the several
                hash-to-curve options defined in
                <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>.
                The specific choice of the hash-to-curve option
                (called Suite ID in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>)
                is given by the h2c_suite_ID_string parameter.<a href="#section-5.4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.4.1.2-2">
                ECVRF_encode_to_curve_h2c_suite(encode_to_curve_salt, alpha_string)<a href="#section-5.4.1.2-2" class="pilcrow">¶</a></p>
<p id="section-5.4.1.2-3">
                Fixed option (specified in <a href="#ecvrfSuites" class="xref">Section 5.5</a>):<a href="#section-5.4.1.2-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4.1.2-4.1">h2c_suite_ID_string - a hash-to-curve suite ID, encoded in ASCII (see discussion below)<a href="#section-5.4.1.2-4.1" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.4.1.2-5">
                Steps:<a href="#section-5.4.1.2-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.1.2-6">
              <li id="section-5.4.1.2-6.1">string_to_be_hashed = encode_to_curve_salt || alpha_string<a href="#section-5.4.1.2-6.1" class="pilcrow">¶</a>
</li>
              <li id="section-5.4.1.2-6.2">
                <p id="section-5.4.1.2-6.2.1">H = encode(string_to_be_hashed)<a href="#section-5.4.1.2-6.2.1" class="pilcrow">¶</a></p>
<p id="section-5.4.1.2-6.2.2">(the encode function is discussed below)<a href="#section-5.4.1.2-6.2.2" class="pilcrow">¶</a></p>
</li>
              <li id="section-5.4.1.2-6.3">Output H<a href="#section-5.4.1.2-6.3" class="pilcrow">¶</a>
</li>
            </ol>
<p id="section-5.4.1.2-7">The encode function is provided by the hash-to-curve suite whose ID is h2c_suite_ID_string, as specified in
                <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>, Section 8.
                The domain separation tag DST, a parameter to the hash-to-curve suite, SHALL be set to<a href="#section-5.4.1.2-7" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4.1.2-8.1">
                    "ECVRF_" || h2c_suite_ID_string || suite_string<a href="#section-5.4.1.2-8.1" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.4.1.2-9">
                where "ECVRF_" is represented as a 6-byte ASCII encoding (in hexadecimal, octets 45 43 56 52 46 5F).<a href="#section-5.4.1.2-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ecvrfNonceGeneration">
<section id="section-5.4.2">
          <h4 id="name-ecvrf-nonce-generation">
<a href="#section-5.4.2" class="section-number selfRef">5.4.2. </a><a href="#name-ecvrf-nonce-generation" class="section-name selfRef">ECVRF Nonce Generation</a>
          </h4>
<p id="section-5.4.2-1">The following algorithms generate the
        nonce value k in a deterministic pseudorandom fashion.
            This section specifies a number of such algorithms, which are not compatible with each other.
            The choice of a particular algorithm from the options specified in this section depends on the ciphersuite, as specified in <a href="#ecvrfSuites" class="xref">Section 5.5</a>.<a href="#section-5.4.2-1" class="pilcrow">¶</a></p>
<div id="nonceP256">
<section id="section-5.4.2.1">
            <h5 id="name-ecvrf-nonce-generation-from">
<a href="#section-5.4.2.1" class="section-number selfRef">5.4.2.1. </a><a href="#name-ecvrf-nonce-generation-from" class="section-name selfRef">ECVRF Nonce Generation from RFC 6979</a>
            </h5>
<p id="section-5.4.2.1-1">
                    ECVRF_nonce_generation_RFC6979(SK, h_string)<a href="#section-5.4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.4.2.1-2">
                    Input:<a href="#section-5.4.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4.2.1-3.1">SK - an ECVRF secret key<a href="#section-5.4.2.1-3.1" class="pilcrow">¶</a>
</li>
              <li class="normal ulEmpty" id="section-5.4.2.1-3.2">h_string - an octet string<a href="#section-5.4.2.1-3.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.4.2.1-4">
                    Output:<a href="#section-5.4.2.1-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4.2.1-5.1">k - an integer nonce between 1 and q-1<a href="#section-5.4.2.1-5.1" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.4.2.1-6">
                    The ECVRF_nonce_generation function is as specified in 
                    <span>[<a href="#RFC6979" class="xref">RFC6979</a>]</span> Section 3.2 where<a href="#section-5.4.2.1-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4.2.1-7.1"> Input m is set equal to h_string<a href="#section-5.4.2.1-7.1" class="pilcrow">¶</a>
</li>
              <li class="normal ulEmpty" id="section-5.4.2.1-7.2"> The "suitable for DSA or ECDSA" check in step h.3 is omitted<a href="#section-5.4.2.1-7.2" class="pilcrow">¶</a>
</li>
              <li class="normal ulEmpty" id="section-5.4.2.1-7.3"> The hash function H is Hash and its output length hlen (in bits) is set as hLen*8<a href="#section-5.4.2.1-7.3" class="pilcrow">¶</a>
</li>
              <li class="normal ulEmpty" id="section-5.4.2.1-7.4"> The secret key x is set equal to the VRF secret scalar x<a href="#section-5.4.2.1-7.4" class="pilcrow">¶</a>
</li>
              <li class="normal ulEmpty" id="section-5.4.2.1-7.5"> The prime q is the same as in this specification<a href="#section-5.4.2.1-7.5" class="pilcrow">¶</a>
</li>
              <li class="normal ulEmpty" id="section-5.4.2.1-7.6"> qlen is the binary length of q, i.e., the smallest integer such that 2^qlen &gt; q (this qlen is not to be confused with qLen in this document, which is the length of q in octets)<a href="#section-5.4.2.1-7.6" class="pilcrow">¶</a>
</li>
              <li class="normal ulEmpty" id="section-5.4.2.1-7.7"> All the other values and primitives as defined in <span>[<a href="#RFC6979" class="xref">RFC6979</a>]</span><a href="#section-5.4.2.1-7.7" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="nonce25519">
<section id="section-5.4.2.2">
            <h5 id="name-ecvrf-nonce-generation-from-">
<a href="#section-5.4.2.2" class="section-number selfRef">5.4.2.2. </a><a href="#name-ecvrf-nonce-generation-from-" class="section-name selfRef">ECVRF Nonce Generation from RFC 8032</a>
            </h5>
<p id="section-5.4.2.2-1"> The following is from Steps 2-3 of Section 5.1.6
                in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>. To use this algorithm, hLen MUST be at least 64.<a href="#section-5.4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.4.2.2-2">
                    ECVRF_nonce_generation_RFC8032(SK, h_string)<a href="#section-5.4.2.2-2" class="pilcrow">¶</a></p>
<p id="section-5.4.2.2-3">
                    Input:<a href="#section-5.4.2.2-3" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4.2.2-4.1">SK - an ECVRF secret key<a href="#section-5.4.2.2-4.1" class="pilcrow">¶</a>
</li>
              <li class="normal ulEmpty" id="section-5.4.2.2-4.2">h_string - an octet string<a href="#section-5.4.2.2-4.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.4.2.2-5">
                    Output:<a href="#section-5.4.2.2-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4.2.2-6.1">k - an integer nonce between 0 and q-1<a href="#section-5.4.2.2-6.1" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.4.2.2-7">
                    Steps:<a href="#section-5.4.2.2-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.2.2-8">
<li id="section-5.4.2.2-8.1">hashed_sk_string = Hash(SK)<a href="#section-5.4.2.2-8.1" class="pilcrow">¶</a>
</li>
              <li id="section-5.4.2.2-8.2">truncated_hashed_sk_string = hashed_sk_string[32]...hashed_sk_string[63]<a href="#section-5.4.2.2-8.2" class="pilcrow">¶</a>
</li>
              <li id="section-5.4.2.2-8.3">k_string = Hash(truncated_hashed_sk_string || h_string)<a href="#section-5.4.2.2-8.3" class="pilcrow">¶</a>
</li>
              <li id="section-5.4.2.2-8.4">k = string_to_int(k_string) mod q<a href="#section-5.4.2.2-8.4" class="pilcrow">¶</a>
</li>
            </ol>
</section>
</div>
</section>
</div>
<div id="ecvrfChallengeGeneration">
<section id="section-5.4.3">
          <h4 id="name-ecvrf-challenge-generation">
<a href="#section-5.4.3" class="section-number selfRef">5.4.3. </a><a href="#name-ecvrf-challenge-generation" class="section-name selfRef">ECVRF Challenge Generation</a>
          </h4>
<p id="section-5.4.3-1">
                ECVRF_challenge_generation(P1, P2, P3, P4, P5)<a href="#section-5.4.3-1" class="pilcrow">¶</a></p>
<p id="section-5.4.3-2">
                Input:<a href="#section-5.4.3-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4.3-3.1">P1, P2, P3, P4, P5 - EC points<a href="#section-5.4.3-3.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.4.3-4">
                Output:<a href="#section-5.4.3-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4.3-5.1">c - challenge value, integer between 0 and 2^(8*cLen)-1<a href="#section-5.4.3-5.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.4.3-6">
                Steps:<a href="#section-5.4.3-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.3-7">
<li id="section-5.4.3-7.1">challenge_generation_domain_separator_front = 0x02<a href="#section-5.4.3-7.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.3-7.2">Initialize str = suite_string || challenge_generation_domain_separator_front<a href="#section-5.4.3-7.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.3-7.3">
              <p id="section-5.4.3-7.3.1">for PJ in [P1, P2, P3, P4, P5]:<a href="#section-5.4.3-7.3.1" class="pilcrow">¶</a></p>
<p id="section-5.4.3-7.3.2">str = str || point_to_string(PJ)<a href="#section-5.4.3-7.3.2" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.3-7.4">challenge_generation_domain_separator_back = 0x00<a href="#section-5.4.3-7.4" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.3-7.5">str = str || challenge_generation_domain_separator_back<a href="#section-5.4.3-7.5" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.3-7.6">c_string = Hash(str)<a href="#section-5.4.3-7.6" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.3-7.7">truncated_c_string = c_string[0]...c_string[cLen-1]<a href="#section-5.4.3-7.7" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.3-7.8">c = string_to_int(truncated_c_string)<a href="#section-5.4.3-7.8" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.3-7.9">Output c<a href="#section-5.4.3-7.9" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="ecvrfDecodeProof">
<section id="section-5.4.4">
          <h4 id="name-ecvrf-decode-proof">
<a href="#section-5.4.4" class="section-number selfRef">5.4.4. </a><a href="#name-ecvrf-decode-proof" class="section-name selfRef">ECVRF Decode Proof</a>
          </h4>
<p id="section-5.4.4-1">
                ECVRF_decode_proof(pi_string)<a href="#section-5.4.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4.4-2">
                Input:<a href="#section-5.4.4-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4.4-3.1">pi_string - VRF proof, octet string (ptLen+cLen+qLen octets)<a href="#section-5.4.4-3.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.4.4-4">
                Output:<a href="#section-5.4.4-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4.4-5.1">"INVALID", or<a href="#section-5.4.4-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-5.4.4-5.2">Gamma - a point on E<a href="#section-5.4.4-5.2" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-5.4.4-5.3">
                    c - integer between 0 and 2^(8*cLen)-1<a href="#section-5.4.4-5.3" class="pilcrow">¶</a>
</li>
            <li class="normal ulEmpty" id="section-5.4.4-5.4">
                    s - integer between 0 and q-1<a href="#section-5.4.4-5.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.4.4-6">
                Steps:<a href="#section-5.4.4-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.4-7">
<li id="section-5.4.4-7.1">gamma_string = pi_string[0]...pi_string[ptLen-1]<a href="#section-5.4.4-7.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.4-7.2">c_string = pi_string[ptLen]...pi_string[ptLen+cLen-1]<a href="#section-5.4.4-7.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.4-7.3">s_string = pi_string[ptLen+cLen]...pi_string[ptLen+cLen+qLen-1]<a href="#section-5.4.4-7.3" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.4-7.4">Gamma = string_to_point(gamma_string)<a href="#section-5.4.4-7.4" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.4-7.5">if Gamma = "INVALID" output "INVALID" and stop<a href="#section-5.4.4-7.5" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.4-7.6">c = string_to_int(c_string)<a href="#section-5.4.4-7.6" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.4-7.7">s = string_to_int(s_string)<a href="#section-5.4.4-7.7" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.4-7.8">if s &gt;= q output "INVALID" and stop<a href="#section-5.4.4-7.8" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.4-7.9">Output Gamma, c, and s<a href="#section-5.4.4-7.9" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="keycheck">
<section id="section-5.4.5">
          <h4 id="name-ecvrf-validate-key">
<a href="#section-5.4.5" class="section-number selfRef">5.4.5. </a><a href="#name-ecvrf-validate-key" class="section-name selfRef">ECVRF Validate Key</a>
          </h4>
<p id="section-5.4.5-1">
                  ECVRF_validate_key(Y)<a href="#section-5.4.5-1" class="pilcrow">¶</a></p>
<p id="section-5.4.5-2">
                  Input:<a href="#section-5.4.5-2" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4.5-3.1">Y - public key, a point on E<a href="#section-5.4.5-3.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.4.5-4">
                  Output:<a href="#section-5.4.5-4" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.4.5-5.1">"VALID" or "INVALID"<a href="#section-5.4.5-5.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.4.5-6">
            Important note: the public key Y given to this procedure MUST be a valid point on E.<a href="#section-5.4.5-6" class="pilcrow">¶</a></p>
<p id="section-5.4.5-7">
            Steps:<a href="#section-5.4.5-7" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.5-8">
              <li id="section-5.4.5-8.1">Let Y' = cofactor*Y<a href="#section-5.4.5-8.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.5-8.2">If Y' is the identity element of the elliptic curve group, output "INVALID" and stop<a href="#section-5.4.5-8.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.5-8.3">Output "VALID"<a href="#section-5.4.5-8.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-5.4.5-9">Note that if the cofactor = 1, then Step 1 simply sets Y'=Y. In particular, for the P-256 curve, ECVRF_validate_key simply ensures that Y is not the point at infinity.<a href="#section-5.4.5-9" class="pilcrow">¶</a></p>
<p id="section-5.4.5-10">
                Also note that if the cofactor is small, the total number
                  of Y values that could cause Step 2 to output "INVALID" may be small, and it may be more efficient to simply
                  check Y against a fixed list of such points. For example, the following algorithm can be used for the edwards25519 curve:<a href="#section-5.4.5-10" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4.5-11">
              <li id="section-5.4.5-11.1">PK_string = point_to_string(Y)<a href="#section-5.4.5-11.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.5-11.2">oneTwentySeven_string = 0x7F<a href="#section-5.4.5-11.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.5-11.3">
              <p id="section-5.4.5-11.3.1">y_string[31] = y_string[31] &amp; oneTwentySeven_string<a href="#section-5.4.5-11.3.1" class="pilcrow">¶</a></p>
<p id="section-5.4.5-11.3.2">(this step clears the high-order bit of octet 31)<a href="#section-5.4.5-11.3.2" class="pilcrow">¶</a></p>
</li>
            <li id="section-5.4.5-11.4">bad_pk[0] = int_to_string(0, 32)<a href="#section-5.4.5-11.4" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.5-11.5">bad_pk[1] = int_to_string(1, 32)<a href="#section-5.4.5-11.5" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.5-11.6">bad_y2 = 2707385501144840649318225287225658788936804267575313519463743609750303402022<a href="#section-5.4.5-11.6" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.5-11.7">bad_pk[2] = int_to_string(bad_y2, 32)<a href="#section-5.4.5-11.7" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.5-11.8">bad_pk[3] = int_to_string(p-bad_y2, 32)<a href="#section-5.4.5-11.8" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.5-11.9">bad_pk[4] = int_to_string(p-1, 32)<a href="#section-5.4.5-11.9" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.5-11.10">bad_pk[5] = int_to_string(p, 32)<a href="#section-5.4.5-11.10" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.5-11.11">bad_pk[6] = int_to_string(p+1, 32)<a href="#section-5.4.5-11.11" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.5-11.12">If y_string is in the list [bad_pk[0],...,bad_pk[6]], output "INVALID" and stop<a href="#section-5.4.5-11.12" class="pilcrow">¶</a>
</li>
            <li id="section-5.4.5-11.13">Output Y<a href="#section-5.4.5-11.13" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-5.4.5-12">
                  (bad_pk[0], bad_pk[2], bad_pk[3] each match two bad public keys, depending on the sign of the x-coordinate, which was cleared in step 5, in order to make sure that it does not affect the comparison. bad_pk[1] and bad_pk[4] each match one bad public key, because x-coordinate is 0 for these two public keys. bad_pk[5] and bad_pk[6] are simply bad_pk[0] and bad_pk[1] shifted by p, in case the y-coordinate had not been modular reduced by p. There is no need to shift the other bad_pk values by p, because they will exceed 2^255. These bad keys, which represent all points of order 1, 2, 4, and 8, have been obtained by converting the points specified in <span>[<a href="#X25519" class="xref">X25519</a>]</span> to Edwards coordinates.)<a href="#section-5.4.5-12" class="pilcrow">¶</a></p>
</section>
</div>
</section>
<div id="ecvrfSuites">
<section id="section-5.5">
        <h3 id="name-ecvrf-ciphersuites">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-ecvrf-ciphersuites" class="section-name selfRef">ECVRF Ciphersuites</a>
        </h3>
<p id="section-5.5-1">This document defines ECVRF-P256-SHA256-TAI as follows:<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5-2.1">
        suite_string = 0x01.<a href="#section-5.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-2.2">
            The EC group G is the NIST P-256 elliptic curve, with curve parameters
            as specified in <span>[<a href="#FIPS-186-4" class="xref">FIPS-186-4</a>]</span> (Section D.1.2.3)
            and <span>[<a href="#RFC5114" class="xref">RFC5114</a>]</span>  (Section 2.6). For this group,
             fLen = qLen = 32 and cofactor = 1.<a href="#section-5.5-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-2.3">
              cLen = 16.<a href="#section-5.5-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-2.4"> The key pair generation primitive is specified in
            Section 3.2.1 of <span>[<a href="#SECG1" class="xref">SECG1</a>]</span> (q, B, SK, and Y in this document
            correspond to n, G, d, and Q in Section 3.2.1 of <span>[<a href="#SECG1" class="xref">SECG1</a>]</span>).
            In this ciphersuite, the secret scalar x is equal to the private key SK.<a href="#section-5.5-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-2.5"> encode_to_curve_salt = PK_string<a href="#section-5.5-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-2.6"> The ECVRF_nonce_generation function is as specified in <a href="#nonceP256" class="xref">Section 5.4.2.1</a>.<a href="#section-5.5-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-2.7">The int_to_string function is the I2OSP function specified in Section 
        4.1 of <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span>. (This is big-endian representation.)<a href="#section-5.5-2.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-2.8">The string_to_int function is the OS2IP function specified in Section 
        4.2 of <span>[<a href="#RFC8017" class="xref">RFC8017</a>]</span>. (This is big-endian representation.)<a href="#section-5.5-2.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-2.9">
            The point_to_string function converts a point on E to an octet string
            according to the encoding specified in Section 2.3.3 of 
            <span>[<a href="#SECG1" class="xref">SECG1</a>]</span> with point compression on.
            This implies ptLen = fLen + 1 = 33.
            (Note that certain software implementations do not introduce a
             separate elliptic curve point type and instead directly treat the
             EC point as an octet string per above encoding. When using such 
             an implementation, the point_to_string function 
             can be treated as the identity function.)<a href="#section-5.5-2.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-2.10"> The string_to_point function converts an octet string to an 
            a point on E according to the encoding specified in Section 2.3.4 of
            <span>[<a href="#SECG1" class="xref">SECG1</a>]</span>. This function MUST output INVALID if
            the octet string does not decode to a point on the curve E.<a href="#section-5.5-2.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-2.11">
            The hash function Hash is SHA-256 as specified in <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>, with hLen = 32.<a href="#section-5.5-2.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-2.12">
            The ECVRF_encode_to_curve function is as specified in <a href="#ecvrfH2C1" class="xref">Section 5.4.1.1</a>, with interpret_hash_value_as_a_point(s) = string_to_point(0x02 || s).<a href="#section-5.5-2.12" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.5-3">This document defines ECVRF-P256-SHA256-SSWU as identical to ECVRF-P256-SHA256-TAI, except that:<a href="#section-5.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5-4.1"> suite_string = 0x02.<a href="#section-5.5-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-4.2">the ECVRF_encode_to_curve function is as specified in <a href="#h2csuite" class="xref">Section 5.4.1.2</a>
                        with h2c_suite_ID_string = P256_XMD:SHA-256_SSWU_NU_
                        (the suite is defined in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> Section 8.2)<a href="#section-5.5-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.5-5">This document defines ECVRF-EDWARDS25519-SHA512-TAI as follows:<a href="#section-5.5-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5-6.1">
        suite_string = 0x03.<a href="#section-5.5-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-6.2">
            The EC group G is the edwards25519
            elliptic curve with parameters defined in Table 1 of
             <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.       
            For this group, fLen = qLen = 32 and cofactor = 8.<a href="#section-5.5-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-6.3">
              cLen = 16.<a href="#section-5.5-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-6.4"> The private key and generation of the secret scalar and the public 
        key are specified in Section 5.1.5 of <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.<a href="#section-5.5-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-6.5"> encode_to_curve_salt = PK_string<a href="#section-5.5-6.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-6.6"> The ECVRF_nonce_generation function is as specified in <a href="#nonce25519" class="xref">Section 5.4.2.2</a>.<a href="#section-5.5-6.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-6.7">The int_to_string function as specified in the first paragraph of
        Section 5.1.2 of <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>. (This is little-endian representation.)<a href="#section-5.5-6.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-6.8">The string_to_int function interprets the string as an integer in little-endian
       representation.<a href="#section-5.5-6.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-6.9"> The point_to_string function converts an point on E to an
            octet string according to the encoding specified
             in Section 5.1.2 of <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>. 
            This implies ptLen = fLen = 32.
            (Note that certain software implementations do not introduce a
             separate elliptic curve point type and instead directly treat the
             EC point as an octet string per above encoding. When using such
             and implementation, the point_to_string 
             function can be treated as the identity function.)<a href="#section-5.5-6.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-6.10"> The string_to_point function converts an octet string to a point on E
        according to the encoding specified in Section 5.1.3 
        of <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.  This function MUST output INVALID if
            the octet string does not decode to a point on the curve E.<a href="#section-5.5-6.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-6.11">
            The hash function Hash is SHA-512 as specified in <span>[<a href="#RFC6234" class="xref">RFC6234</a>]</span>, with hLen = 64.<a href="#section-5.5-6.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-6.12">
            The ECVRF_encode_to_curve function is as specified in <a href="#ecvrfH2C1" class="xref">Section 5.4.1.1</a>, with interpret_hash_value_as_a_point(s) = string_to_point(s[0]...s[31]).<a href="#section-5.5-6.12" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.5-7">This document defines ECVRF-EDWARDS25519-SHA512-ELL2 as identical to ECVRF-EDWARDS25519-SHA512-TAI, except:<a href="#section-5.5-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5-8.1">
            suite_string = 0x04.<a href="#section-5.5-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.5-8.2">the ECVRF_encode_to_curve function is as specified in <a href="#h2csuite" class="xref">Section 5.4.1.2</a> with
            h2c_suite_ID_string = edwards25519_XMD:SHA-512_ELL2_NU_
            (the suite is defined in
            <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span> Section 8.5).<a href="#section-5.5-8.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="imp">
<section id="section-6">
      <h2 id="name-implementation-status">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
      </h2>
<p id="section-6-1">
            Note to RFC editor: Remove before publication<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">
    A reference C++ implementation of ECVRF-P256-SHA256-TAI, ECVRF-P256-SHA256-SSWU, ECVRF-EDWARDS25519-SHA512-TAI, and ECVRF-EDWARDS25519-SHA512-ELL2
    is available at <span><a href="https://github.com/reyzin/ecvrf">https://github.com/reyzin/ecvrf</a></span>. This implementation is neither secure nor especially efficient, but can be used to generate
        test vectors.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">
      A Python implementation of an older version of ECVRF-EDWARDS25519-SHA512-ELL2 from the -05 version of this draft is available at <span><a href="https://github.com/integritychain/draft-irtf-cfrg-vrf-05">https://github.com/integritychain/draft-irtf-cfrg-vrf-05</a></span>.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">
      A C implementation of an older version of ECVRF-EDWARDS25519-SHA512-ELL2 from the -03 version of this draft is available at <span><a href="https://github.com/algorand/libsodium/tree/draft-irtf-cfrg-vrf-03/src/libsodium/crypto_vrf/ietfdraft03">https://github.com/algorand/libsodium/tree/draft-irtf-cfrg-vrf-03/src/libsodium/crypto_vrf/ietfdraft03</a></span>.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">
      A Rust implementation of an older version of ECVRF-P256-SHA256-TAI from the -05 version of this draft, as well as variants for the sect163k1 and secp256k1 curves, is available at <span><a href="https://crates.io/crates/vrf">https://crates.io/crates/vrf</a></span>.<a href="#section-6-5" class="pilcrow">¶</a></p>
<p id="section-6-6">
      A C implementation of a variant of ECVRF-P256-SHA256-TAI from the -05 version of this draft adapted for the secp256k1 curve is available at <span><a href="https://github.com/aergoio/secp256k1-vrf">https://github.com/aergoio/secp256k1-vrf</a></span>.<a href="#section-6-6" class="pilcrow">¶</a></p>
<p id="section-6-7">
            An implementation of an earlier version of RSA-FDH-VRF (SHA-256) and ECVRF-P256-SHA256-TAI was
            first developed
            as a part of the NSEC5 project <span>[<a href="#I-D.vcelak-nsec5" class="xref">I-D.vcelak-nsec5</a>]</span> and is available
            at <span><a href="http://github.com/fcelda/nsec5-crypto">http://github.com/fcelda/nsec5-crypto</a></span>.<a href="#section-6-7" class="pilcrow">¶</a></p>
<p id="section-6-8">
    The Key Transparency project at Google
    uses a VRF implementation that is similar to
    the ECVRF-P256-SHA256-TAI, with a few changes
    including the use of SHA-512 instead of SHA-256. Its implementation
    is available at <span><a href="https://github.com/google/keytransparency/blob/master/core/crypto/vrf/">https://github.com/google/keytransparency/blob/master/core/crypto/vrf/</a></span><a href="#section-6-8" class="pilcrow">¶</a></p>
<p id="section-6-9">
    An implementation by Ryuji Ishiguro following an older version of ECVRF-EDWARDS25519-SHA512-TAI from the -00 version of this draft is available at
    <span><a href="https://github.com/r2ishiguro/vrf">https://github.com/r2ishiguro/vrf</a></span>.<a href="#section-6-9" class="pilcrow">¶</a></p>
<p id="section-6-10">
    An implementation similar to ECVRF-EDWARDS25519-SHA512-ELL2 (with some changes, including the use of SHA-3) is available as part of the
    CONIKS implementation in Golang at 
    <span><a href="https://github.com/coniks-sys/coniks-go/tree/master/crypto/vrf">https://github.com/coniks-sys/coniks-go/tree/master/crypto/vrf</a></span>.<a href="#section-6-10" class="pilcrow">¶</a></p>
<p id="section-6-11">
    Open Whisper Systems also uses a VRF similar to
    ECVRF-EDWARDS25519-SHA512-ELL2, called VXEdDSA, and specified here
    <span><a href="https://whispersystems.org/docs/specifications/xeddsa/">https://whispersystems.org/docs/specifications/xeddsa/</a></span>
    and here <span><a href="https://moderncrypto.org/mail-archive/curves/2017/000925.html">https://moderncrypto.org/mail-archive/curves/2017/000925.html</a></span>.
    Implementations in C and Java are available at <span><a href="https://github.com/signalapp/curve25519-java">https://github.com/signalapp/curve25519-java</a></span> and
    <span><a href="https://github.com/wavesplatform/curve25519-java">https://github.com/wavesplatform/curve25519-java</a></span>.<a href="#section-6-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="securitycons">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<section id="section-7.1">
        <h3 id="name-key-generation">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-key-generation" class="section-name selfRef">Key Generation</a>
        </h3>
<p id="section-7.1-1">Applications that use the VRFs defined in this
    document MUST ensure that the VRF key is generated correctly,
    using good randomness.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<div id="untrustedkeys">
<section id="section-7.1.1">
          <h4 id="name-uniqueness-and-collision-re">
<a href="#section-7.1.1" class="section-number selfRef">7.1.1. </a><a href="#name-uniqueness-and-collision-re" class="section-name selfRef">Uniqueness and collision resistance with untrusted keys</a>
          </h4>
<p id="section-7.1.1-1">The RSA-FDH-VRF satisfies the "trusted uniqueness" (see <a href="#uniqueness" class="xref">Section 3.1</a>)
              and "trusted collision resistance"
              (see <a href="#collisionresistance" class="xref">Section 3.2</a>) properties
    as long as the VRF keys are generated correctly.
    Uniqueness and collision resistance may not hold if the keys are generated adversarially
    (specifically, if the RSA function specified in the public key is not bijective because the modulus n or the exponent e are chosen not in compliance with the stadnard); thus,
    RSA-FDH-VRF defined in this document does not have "full uniqueness" and "full collision resistance".
    Therefore, if adversarial key generation is a concern, the
    RSA-FDH-VRF has to be enhanced by additional cryptographic checks
    that its public key has the right form.  These enhacements are left for future specification.<a href="#section-7.1.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1.1-2">For the ECVRF, the Verifier MUST obtain E and B from a trusted source, such as a ciphersuite specification, rather than from the prover. If the verifier does so, then the
              ECVRF
    satisfies the "full uniqueness" (see <a href="#uniqueness" class="xref">Section 3.1</a>)
    and "trusted collision resistance" (see <a href="#collisionresistance" class="xref">Section 3.2</a>) properties. It additonally satisfies "full collision resistance" if validate_key parameter given to the ECVRF_verify is TRUE.<a href="#section-7.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-7.1.2">
          <h4 id="name-pseudorandomness-with-untru">
<a href="#section-7.1.2" class="section-number selfRef">7.1.2. </a><a href="#name-pseudorandomness-with-untru" class="section-name selfRef">Pseudorandomness with untrusted keys</a>
          </h4>
<p id="section-7.1.2-1"> Without good randomness, the "pseudorandomness"
    properties of the VRF may not hold. Note that it is not possible to guarantee 
    pseudorandomness in the face of adversarially generated VRF keys.  This is
    because an adversary can always use bad randomness to generate the VRF keys, 
    and thus, the VRF output may not be pseudorandom.<a href="#section-7.1.2-1" class="pilcrow">¶</a></p>
</section>
</section>
<div id="seclevel">
<section id="section-7.2">
        <h3 id="name-security-levels">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-security-levels" class="section-name selfRef">Security Levels</a>
        </h3>
<p id="section-7.2-1">
            As shown in <span>[<a href="#PWHVNRG17" class="xref">PWHVNRG17</a>]</span>, RSA-FDH-VRF satifies the trusted uniqueness property unconditionally. The security level of the RSA-FDH-VRF, measured in bits, for the other two properties is as follows (in the random oracle model for the functions MGF1 and Hash):<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-2.1">For trusted collision resistance: approximately 8*min(k/2, hLen/2) (as shown in <span>[<a href="#PWHVNRG17" class="xref">PWHVNRG17</a>]</span>).<a href="#section-7.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-2.2">For selective pseudorandomness: approximately as strong as the security, in bits, of the RSA problem for the key (n, e) (as shown in <span>[<a href="#GNPRVZ15" class="xref">GNPRVZ15</a>]</span>).<a href="#section-7.2-2.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.2-3">
            As shown in <span>[<a href="#PWHVNRG17" class="xref">PWHVNRG17</a>]</span>, the security level of the ECVRF, measured in bits, is as follows (in the random oracle model for the functions Hash and ECVRF_encode_to_curve):<a href="#section-7.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2-4.1">For trusted uniqueness: approximately 8*min(qLen, cLen).<a href="#section-7.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-4.2">For collision resistance (trusted or full, depending on whether validation is performed as explained in <a href="#untrustedkeys" class="xref">Section 7.1.1</a>): approximately 8*min(qLen/2, hLen/2).<a href="#section-7.2-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.2-4.3">For the selective pseudorandomness property: approximately as strong as the security, in bits, of the decisional Diffie-Hellman problem in the group G (which is at most 8*qLen/2).<a href="#section-7.2-4.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-7.2-5">See <a href="#secdef" class="xref">Section 3</a> for the definitions of these security properties. See <a href="#prsecurity" class="xref">Section 7.3</a> for the discussion of full pseudorandomness.<a href="#section-7.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="prsecurity">
<section id="section-7.3">
        <h3 id="name-selective-vs-full-pseudoran">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-selective-vs-full-pseudoran" class="section-name selfRef">Selective vs. Full Pseudorandomness</a>
        </h3>
<p id="section-7.3-1"><span>[<a href="#PWHVNRG17" class="xref">PWHVNRG17</a>]</span> presents cryptographic reductions to an
    underlying hard problem (namely, the RSA problem for RSA-FDH-VRF
    and the Decisional Diffie-Hellman problem for the ECVRF)
    to prove that the VRFs specified in this
    document possess not only selective pseudorandomness, but also
    full pseudorandomness
    (see <a href="#pseudodef" class="xref">Section 3.3</a> for an explanation of these notions).
    However, the cryptographic reductions are tighter for selective
    pseudorandomness than for full pseudorandomness. Specifically, the approximate provable security level, measured in bits,
    for full pseudorandomness may be obtained from the provable security level for selective pseudorandomness (given in <a href="#seclevel" class="xref">Section 7.2</a>) by subtracting the binary logarithm
    of the number of proofs produced for a given secret key. This holds for both the RSA-FDH-VRF and the ECVRF.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">While no known attacks against full pseudorandomness are stronger than similar attacks against selective pseudorandomness, some applications may be concerned about tightness of cryptographic
    reductions. Such applications may consider the following two options:<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3-3.1"> They may choose to ensure that selective pseudorandomness is sufficient for
    the application. That is, that
 pseudorandomness of outputs matters only for inputs that are chosen
    independently of the VRF key.<a href="#section-7.3-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.3-3.2">They
    may increase
    security parameters to make up for the loose security reduction. 
    For RSA-FDH-VRF, this means increasing the RSA key length. For 
    ECVRF, this means increasing the cryptographic strength of the EC group
    G by specifying a new ciphersuite.<a href="#section-7.3-3.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<section id="section-7.4">
        <h3 id="name-proper-pseudorandom-nonce-f">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-proper-pseudorandom-nonce-f" class="section-name selfRef">Proper pseudorandom nonce for ECVRF</a>
        </h3>
<p id="section-7.4-1">
    The security of the ECVRF defined in this document relies on the 
    fact that the nonce k used in the ECVRF_prove algorithm is
    chosen uniformly and pseudorandomly modulo q, and is unknown to the adversary.
    Otherwise, an adversary may be able to recover
    the private VRF key x (and thus break pseudorandomness of the VRF)
    after observing several valid VRF proofs pi. The nonce generation methods
    specified in the ECVRF ciphersuites of <a href="#ecvrfSuites" class="xref">Section 5.5</a>
    are designed with this requirement in mind.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
</section>
<section id="section-7.5">
        <h3 id="name-side-channel-attacks">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-side-channel-attacks" class="section-name selfRef">Side-channel attacks</a>
        </h3>
<p id="section-7.5-1">Side channel attacks on cryptographic primitives are an important issue.
        Implementers should
       take care to avoid side-channel attacks that leak information about
       the VRF private key SK (and the nonce k used in the ECVRF), which is
       used in VRF_prove.
       In most applications, VRF_proof_to_hash and VRF_verify
       algorithms take only inputs that are public, and thus side channel
       attacks are typically not a concern for these algorithms.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<p id="section-7.5-2">
    The VRF input alpha may be also a sensitive input to VRF_prove and may
    need to be protected against side channel attacks.
    Below we discuss one particular class of such attacks: timing attacks that can
    be used to leak information about the VRF input alpha.<a href="#section-7.5-2" class="pilcrow">¶</a></p>
<p id="section-7.5-3">The ECVRF_encode_to_curve_try_and_increment algorithm defined in
    <a href="#ecvrfH2C1" class="xref">Section 5.4.1.1</a> SHOULD NOT be used in applications where
    the VRF input alpha is secret and is hashed by the VRF on-the-fly.
    This is because the algorithm's running time depends
    on the VRF input alpha, and thus creates a timing channel that
    can be used to learn information about alpha. 
    That said, for most inputs the amount of information obtained from
    such a timing attack is likely to be small (1 bit, on average), since the algorithm 
    is expected to find a valid curve point after only two attempts.  
    However, there might be inputs which cause the algorithm to make many attempts
    before it finds a valid curve point; for such inputs, the information leaked
    in a timing attack will be more than 1 bit.<a href="#section-7.5-3" class="pilcrow">¶</a></p>
<p id="section-7.5-4">ECVRF-P256-SHA256-SSWU and ECVRF-EDWARDS25519-SHA512-ELL2 can be made to
        run in time independent of alpha, following recommendations in <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>.<a href="#section-7.5-4" class="pilcrow">¶</a></p>
<p id="section-7.5-5"></p>
</section>
<section id="section-7.6">
        <h3 id="name-proofs-provide-no-secrecy-f">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-proofs-provide-no-secrecy-f" class="section-name selfRef">Proofs provide no secrecy for the VRF input</a>
        </h3>
<p id="section-7.6-1">The VRF proof pi is not designed to provide secrecy and, in general, 
        may reveal the VRF input alpha.
        Anyone who knows PK and pi is able to perform an offline
        dictionary attack to search for alpha, by verifying guesses for alpha using VRF_verify.
        This is in contrast to the VRF hash output beta which, without the proof, is pseudorandom
        and thus is designed to reveal no information about alpha.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
</section>
<div id="prehash">
<section id="section-7.7">
        <h3 id="name-prehashing">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-prehashing" class="section-name selfRef">Prehashing</a>
        </h3>
<p id="section-7.7-1">The VRFs specified in this document allow for read-once access to
        the input alpha for both signing and verifying. Thus, additional 
        prehashing of alpha (as specified, for example, in
        <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> for EdDSA signatures) is not needed, 
        even for applications that need to handle long alpha or
        to support the
        Initialize-Update-Finalize (IUF) interface (in such an interface,
        alpha is not supplied
        all at once, but rather in pieces by a sequence of calls to Update).
        The ECVRF, in particular, uses alpha only in
        ECVRF_encode_to_curve. The curve point H becomes the representative
        of alpha thereafter.<a href="#section-7.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="domainsep">
<section id="section-7.8">
        <h3 id="name-hash-function-domain-separa">
<a href="#section-7.8" class="section-number selfRef">7.8. </a><a href="#name-hash-function-domain-separa" class="section-name selfRef">Hash function domain separation</a>
        </h3>
<p id="section-7.8-1">
         Hashing is used for different purposes in the two VRFs (namely, in the RSA-FDH-VRF, in MGF1 and in proof_to_hash; in the ECVRF, in encode_to_curve, nonce_generation, challenge_generation, and proof_to_hash). The
         theoretical analysis treats each of these functions as a separate hash function, modeled as a random oracle.
         This analysis still holds even if the same hash function is used, as long as the four 
         queries made to the hash function for a given SK and alpha are overwhelmingly unlikely 
         to equal each other or to any queries made to the hash function for the same SK and 
         different alpha. This is indeed the case for the RSA-FDH-VRF defined in this document, because the second octets
         of the input to the hash function used in MGF1 and in proof_to_hash are different.<a href="#section-7.8-1" class="pilcrow">¶</a></p>
<p id="section-7.8-2">
         This is also the case for the ECVRF ciphersuites defined in this document, because:<a href="#section-7.8-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.8-3.1">inputs to the hash function used during nonce_generation are unlikely to equal 
          inputs used in encode_to_curve, proof_to_hash, and challenge_generation. This
          follows since nonce_generation inputs a secret to the hash function that is not used by 
          honest parties as input to any other hash function, and is not available to the adversary.<a href="#section-7.8-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.8-3.2">the second octets of the inputs to the hash function used in
          proof_to_hash, challenge_generation, and encode_to_curve_try_and_increment
          are all different.<a href="#section-7.8-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.8-3.3">the last octet of the input to the hash function used in
          proof_to_hash, challenge_generation, and encode_to_curve_try_and_increment is always zero,
          and therefore different from the last octet of the input to the hash function used in ECVRF_encode_to_curve_h2c_suite,
          which is set equal to the nonzero length of the domain separation tag by <span>[<a href="#I-D.irtf-cfrg-hash-to-curve" class="xref">I-D.irtf-cfrg-hash-to-curve</a>]</span>.<a href="#section-7.8-3.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="salt">
<section id="section-7.9">
        <h3 id="name-hash-function-salting">
<a href="#section-7.9" class="section-number selfRef">7.9. </a><a href="#name-hash-function-salting" class="section-name selfRef">Hash function salting</a>
        </h3>
<p id="section-7.9-1">
        In case a hash collision is found, in order to make it more difficult for the adversary to exploit such a collision, the MGF1 function for the RSA-FDH-VRF and ECVRF_encode_to_curve function for the ECVRF use a public value in addition to alpha (as a so-called salt). This value is determined by the ciphersuite. For the ciphersuites defined in this document, it is set equal to the string representation of the RSA modulus and EC public key, respectively. Implementations that do not use one of the ciphersuites (see <a href="#futureproofing" class="xref">Section 7.10</a>) MAY use a different salt. For example, if a group of public keys to share the same salt, then the hash of the VRF input alpha will be the same for the entire group of public keys, which may aid in some protocol that uses the VRF.<a href="#section-7.9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="futureproofing">
<section id="section-7.10">
        <h3 id="name-futureproofing">
<a href="#section-7.10" class="section-number selfRef">7.10. </a><a href="#name-futureproofing" class="section-name selfRef">Futureproofing</a>
        </h3>
<p id="section-7.10-1">if future designs need to specify variants (e.g., additional ciphersuites) of the RSA-FDH-VRF or the ECVRF in this document,
            then, to avoid the possibility
            that an adversary can obtain a VRF output under one variant, and then claim it was obtained under
            another variant,
           they should specify a different suite_string constant. The suite_string constants in this document are all single octets; if a future suite_string constant is longer than one octet, then it should start with a different octet than the suite_string constants in this document. Then, for the RSA-FDH-VRF, the inputs to the hash function used in MGF1 and proof_to_hash will be different from other ciphersuites.
        For the ECVRF, the inputs
        ECVRF_encode_to_curve hash function used in producing H are then guaranteed to be different from other
        ciphersuites; since all the other hashing done by the prover
        depends on H, inputs to all the hash functions used by the prover will also be
        different from other ciphersuites as long as ECVRF_encode_to_curve is collision resistant.<a href="#section-7.10-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-8">
      <h2 id="name-change-log">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-change-log" class="section-name selfRef">Change Log</a>
      </h2>
<p id="section-8-1">
            Note to RFC Editor: if this document does not obsolete an existing RFC,
            please remove this appendix before publication as an RFC.<a href="#section-8-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty"><li class="normal ulEmpty" id="section-8-2.1"> 00 - Forked this document from draft-goldbe-vrf-01.<a href="#section-8-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-8-2.2"> 01 - Minor updates, mostly highlighting TODO items.<a href="#section-8-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-8-2.3"> 02 - Added specification of elligator2 for Curve25519, along
                with ciphersuites for ECVRF-ED25519-SHA512-Elligator.
                Changed 
                ECVRF-ED25519-SHA256 suite_string to ECVRF-ED25519-SHA512. (This change
                made because Ed25519 in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> signatures 
                use SHA512 and not SHA256.) 
                Made ECVRF nonce generation a separate component, so that nonces are deterministic.
                In ECVRF proving, changed + to - (and made corresponding
                verification changes) in order to be consistent with EdDSA and ECDSA.
                Highlighted that ECVRF_hash_to_curve acts like a prehash.
                Added "suites" variable to ECVRF for futureproofing.
                Ensured domain separation for hash functions by modifying hash_points and added
                discussion about domain separation.
                Updated todos in the "additional pseudorandomness property" 
                section. Added a discussion of secrecy into security considerations.
                Removed B and PK=Y from ECVRF_hash_points because they are already present
                via H, which is computed via hash_to_curve using the suite_string (which identifies B) and Y.<a href="#section-8-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-8-2.4"> 03 - Changed Ed25519 conversions to little-endian, to match RFC 8032;  added simple key validation for Ed25519; added Simple SWU cipher suite; clarified Elligator and removed the extra x0 bit, to make Montgomery and Edwards Elligator the same; added domain separation for RSA VRF; improved notation throughout; added nonce generation as a section; changed counter in try-and-increment from four bytes to one, to avoid endian issues; renamed try-and-increment ciphersuites to -TAI; added qLen as a separate parameter; changed output length to hLen for ECVRF, to match RSAVRF; made Verify return beta so unverified proofs don't end
                    up in proof_to_hash; added test vectors.<a href="#section-8-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-8-2.5"> 04 - Clarified handling of optional arguments x and PK in ECVRF_prove. Edited implementation status to bring it up to date.<a href="#section-8-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-8-2.6"> 05 - Renamed ed25519 into the more commonly used edwards25519. Corrected ECVRF_nonce_generation_RFC6979 (thanks to
                    Gorka Irazoqui Apecechea and Mario Cao Cueto for finding the problem) and corresponding test vectors for the P256 suites. Added a reference to the Rust implementation.<a href="#section-8-2.6" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-8-2.7"> 06 - Made some variable names more descriptive. Added a few implementation references.<a href="#section-8-2.7" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-8-2.8"> 07 - Incorporated hash-to-curve draft by reference to replace our own Elligator2 and Simple SWU. Clarified discussion of EC parameters and functions. Added a 0 octet to all hashing to enforce domain separation from hashing done inside hash-to-curve.<a href="#section-8-2.8" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-8-2.9"> 08 - Incorporated suggestions from crypto panel review by Chloe Martindale. Changed Reyzin's affiliation. Updated references.<a href="#section-8-2.9" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-8-2.10"> 09 - Added a note to remove the implementation page before publication.<a href="#section-8-2.10" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-8-2.11"> 10 - Added a check in ECVRF_decode_proof to ensure that s is reduced mod q. Connected security properties (Section 3) and security considerations (Section 7) with more cross-references.<a href="#section-8-2.11" class="pilcrow">¶</a>
</li>
        <li class="normal ulEmpty" id="section-8-2.12"> 11 - Processed last call comments. Clarified various notation, including lengths of various parameters for ECVRF; added error handling to RSA-FDH-VRF; added security levels section; clarified full vs trusted uniqueness and full vs selective pseudorandomness; added RSA ciphersuites; made key validation clearer; renamed hash_to_curve to encode_to_curve to be consistent with the hash_to_curve draft; allowed a more general salt in hashing, added the public key as input to ECVRF_challenge_generation, and added an explanation about the salt.<a href="#section-8-2.12" class="pilcrow">¶</a>
</li>
      </ul>
</section>
<section id="section-9">
      <h2 id="name-contributors">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<p id="section-9-1">
            This document also would not be possible without the work of
            Moni Naor,
            Sachin Vasant, and
            Asaf Ziv. Chloe Martindale provided a thorough cryptographer's review.
            Liliya Akhmetzyanova, Tony Arcieri, Gary Belvin, Mario Cao Cueto, Brian Chen, Sergey Gorbunov, Shumon Huque, Gorka Irazoqui Apecechea, Marek Jankowski,
            Burt Kaliski, David C. Lawerence, Derek Ting-Haye Leung, Antonio Marcedone, Piotr Nojszewski, Chris Peikert, Trevor Perrin, Sam Scott,
            Stanislav Smyshlyaev, Adam Suhl, Nick Sullivan, Christopher Wood,  Jiayu Xu, and Annie Yousar provided
            valuable input to this draft. Riad Wahby helped this document align with draft-irtf-cfrg-hash-to-curve.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8017">[RFC8017]</dt>
        <dd>
<span class="refAuthor">Moriarty, K., Ed.</span>, <span class="refAuthor">Kaliski, B.</span>, <span class="refAuthor">Jonsson, J.</span>, and <span class="refAuthor">A. Rusch</span>, <span class="refTitle">"PKCS #1: RSA Cryptography Specifications Version 2.2"</span>, <span class="seriesInfo">RFC 8017</span>, <span class="seriesInfo">DOI 10.17487/RFC8017</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8017">https://www.rfc-editor.org/info/rfc8017</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5114">[RFC5114]</dt>
        <dd>
<span class="refAuthor">Lepinski, M.</span> and <span class="refAuthor">S. Kent</span>, <span class="refTitle">"Additional Diffie-Hellman Groups for Use with IETF Standards"</span>, <span class="seriesInfo">RFC 5114</span>, <span class="seriesInfo">DOI 10.17487/RFC5114</span>, <time datetime="2008-01" class="refDate">January 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5114">https://www.rfc-editor.org/info/rfc5114</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6234">[RFC6234]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span> and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"US Secure Hash Algorithms (SHA and SHA-based HMAC and HKDF)"</span>, <span class="seriesInfo">RFC 6234</span>, <span class="seriesInfo">DOI 10.17487/RFC6234</span>, <time datetime="2011-05" class="refDate">May 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6234">https://www.rfc-editor.org/info/rfc6234</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6979">[RFC6979]</dt>
        <dd>
<span class="refAuthor">Pornin, T.</span>, <span class="refTitle">"Deterministic Usage of the Digital Signature Algorithm (DSA) and Elliptic Curve Digital Signature Algorithm (ECDSA)"</span>, <span class="seriesInfo">RFC 6979</span>, <span class="seriesInfo">DOI 10.17487/RFC6979</span>, <time datetime="2013-08" class="refDate">August 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6979">https://www.rfc-editor.org/info/rfc6979</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-cfrg-hash-to-curve">[I-D.irtf-cfrg-hash-to-curve]</dt>
        <dd>
<span class="refAuthor">Faz-Hernandez, A.</span>, <span class="refAuthor">Scott, S.</span>, <span class="refAuthor">Sullivan, N.</span>, <span class="refAuthor">Wahby, R. S.</span>, and <span class="refAuthor">C. A. Wood</span>, <span class="refTitle">"Hashing to Elliptic Curves"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-cfrg-hash-to-curve-13</span>, <time datetime="2021-11-10" class="refDate">10 November 2021</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-13">https://datatracker.ietf.org/doc/html/draft-irtf-cfrg-hash-to-curve-13</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIPS-186-4">[FIPS-186-4]</dt>
        <dd>
<span class="refAuthor">National Institute for Standards and Technology</span>, <span class="refTitle">"Digital Signature Standard (DSS)"</span>, <span class="seriesInfo">FIPS PUB 186-4</span>, <time datetime="2013-07" class="refDate">July 2013</time>, <span>&lt;<a href="https://csrc.nist.gov/publications/detail/fips/186/4/final">https://csrc.nist.gov/publications/detail/fips/186/4/final</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SECG1">[SECG1]</dt>
      <dd>
<span class="refAuthor">Standards for Efficient Cryptography Group (SECG)</span>, <span class="refTitle">"SEC 1: Elliptic Curve Cryptography"</span>, <span class="seriesInfo">Version 2.0</span>, <time datetime="2009-05" class="refDate">May 2009</time>, <span>&lt;<a href="http://www.secg.org/sec1-v2.pdf">http://www.secg.org/sec1-v2.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="ANSI.X9-62-2005">[ANSI.X9-62-2005]</dt>
        <dd>
<span class="refTitle">"Public Key Cryptography for the Financial Services Industry: The Elliptic Curve Digital Signature Algorithm (ECDSA)"</span>, <span class="seriesInfo"> ANSI X9.62</span>, <time datetime="2005" class="refDate">2005</time>. </dd>
<dd class="break"></dd>
<dt id="DGKR18">[DGKR18]</dt>
        <dd>
<span class="refAuthor">David, B.</span>, <span class="refAuthor">Gazi, P.</span>, <span class="refAuthor">Kiayias, A.</span>, and <span class="refAuthor">A. Russell</span>, <span class="refTitle">"Ouroboros Praos: An adaptively-secure, semi-synchronous proof-of-stake protocol"</span>, <span class="seriesInfo">in Advances in Cryptology - EUROCRYPT</span>, <time datetime="2018" class="refDate">2018</time>, <span>&lt;<a href="https://eprint.iacr.org/2017/573">https://eprint.iacr.org/2017/573</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GHMVZ17">[GHMVZ17]</dt>
        <dd>
<span class="refAuthor">Gilad, Y.</span>, <span class="refAuthor">Hemo, R.</span>, <span class="refAuthor">Micali, Y.</span>, <span class="refAuthor">Vlachos, Y.</span>, and <span class="refAuthor">Y. Zeldovich</span>, <span class="refTitle">"Algorand: Scaling Byzantine Agreements for Cryptocurrencies"</span>, <span class="seriesInfo">in Proceedings of the 26th Symposium on Operating Systems Principles (SOSP)</span>, <time datetime="2017" class="refDate">2017</time>, <span>&lt;<a href="https://eprint.iacr.org/2017/454">https://eprint.iacr.org/2017/454</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="GNPRVZ15">[GNPRVZ15]</dt>
        <dd>
<span class="refAuthor">Goldberg, S.</span>, <span class="refAuthor">Naor, M.</span>, <span class="refAuthor">Papadopoulos, D.</span>, <span class="refAuthor">Reyzin, L.</span>, <span class="refAuthor">Vasant, S.</span>, and <span class="refAuthor">A. Ziv</span>, <span class="refTitle">"NSEC5: Provably Preventing DNSSEC Zone Enumeration"</span>, <span class="seriesInfo">in NDSS</span>, <time datetime="2015" class="refDate">2015</time>, <span>&lt;<a href="https://eprint.iacr.org/2014/582.pdf">https://eprint.iacr.org/2014/582.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.vcelak-nsec5">[I-D.vcelak-nsec5]</dt>
        <dd>
<span class="refAuthor">Vcelak, J.</span>, <span class="refAuthor">Goldberg, S.</span>, <span class="refAuthor">Papadopoulos, D.</span>, <span class="refAuthor">Huque, S.</span>, and <span class="refAuthor">D. C. Lawrence</span>, <span class="refTitle">"NSEC5, DNSSEC Authenticated Denial of Existence"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-vcelak-nsec5-08</span>, <time datetime="2018-12-29" class="refDate">29 December 2018</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-vcelak-nsec5-08">https://datatracker.ietf.org/doc/html/draft-vcelak-nsec5-08</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MRV99">[MRV99]</dt>
        <dd>
<span class="refAuthor">Micali, S.</span>, <span class="refAuthor">Rabin, M.</span>, and <span class="refAuthor">S. Vadhan</span>, <span class="refTitle">"Verifiable Random Functions"</span>, <span class="seriesInfo">in FOCS</span>, <time datetime="1999" class="refDate">1999</time>, <span>&lt;<a href="https://dash.harvard.edu/handle/1/5028196">https://dash.harvard.edu/handle/1/5028196</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="PWHVNRG17">[PWHVNRG17]</dt>
        <dd>
<span class="refAuthor">Papadopoulos, D.</span>, <span class="refAuthor">Wessels, D.</span>, <span class="refAuthor">Huque, S.</span>, <span class="refAuthor">Vcelak, J.</span>, <span class="refAuthor">Naor, M.</span>, <span class="refAuthor">Reyzin, L.</span>, and <span class="refAuthor">S. Goldberg</span>, <span class="refTitle">"Making NSEC5 Practical for DNSSEC"</span>, <span class="seriesInfo">in ePrint Cryptology Archive 2017/099</span>, <time datetime="2017-02" class="refDate">February 2017</time>, <span>&lt;<a href="https://eprint.iacr.org/2017/099">https://eprint.iacr.org/2017/099</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="X25519">[X25519]</dt>
      <dd>
<span class="refAuthor">Bernstein, D.J.</span>, <span class="refTitle">"How do I validate Curve25519 public keys?"</span>, <time datetime="2006" class="refDate">2006</time>, <span>&lt;<a href="https://cr.yp.to/ecdh.html#validate">https://cr.yp.to/ecdh.html#validate</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="appendix-A">
      <h2 id="name-test-vectors-for-the-ecvrfs">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-test-vectors-for-the-ecvrfs" class="section-name selfRef">Test Vectors for the ECVRFs</a>
      </h2>
<p id="appendix-A-1">The test vectors in this section were generated using the reference implementation at <span><a href="https://github.com/reyzin/ecvrf">https://github.com/reyzin/ecvrf</a></span>.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<section id="appendix-A.1">
        <h3 id="name-ecvrf-p256-sha256-tai">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-ecvrf-p256-sha256-tai" class="section-name selfRef">ECVRF-P256-SHA256-TAI</a>
        </h3>
<p id="appendix-A.1-1">The example secret keys and messages in Examples 1 and 2 are taken from Appendix A.2.5 of <span>[<a href="#RFC6979" class="xref">RFC6979</a>]</span>.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">Example 1:<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty">
<li class="compact ulEmpty" id="appendix-A.1-3.1">SK = x = c9afa9d845ba75166b5c215767b1d6934e50c3db36e89b127b8a622b120f6721<a href="#appendix-A.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-3.2">PK = 0360fed4ba255a9d31c961eb74c6356d68c049b8923b61fa6ce669622e60f29fb6<a href="#appendix-A.1-3.2" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-3.3">alpha = 73616d706c65 (ASCII "sample")<a href="#appendix-A.1-3.3" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-3.4">try_and_increment succeeded on ctr = 1<a href="#appendix-A.1-3.4" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-3.5">H = 0272a877532e9ac193aff4401234266f59900a4a9e3fc3cfc6a4b7e467a15d06d4<a href="#appendix-A.1-3.5" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-3.6">k = 0d90591273453d2dc67312d39914e3a93e194ab47a58cd598886897076986f77<a href="#appendix-A.1-3.6" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-3.7">U = k*B = 02bb6a034f67643c6183c10f8b41dc4babf88bff154b674e377d90bde009c21672<a href="#appendix-A.1-3.7" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-3.8">V = k*H = 02893ebee7af9a0faa6da810da8a91f9d50e1dc071240c9706726820ff919e8394<a href="#appendix-A.1-3.8" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-3.9">pi = 035b5c726e8c0e2c488a107c600578ee75cb702343c153cb1eb8dec77f4b5071b4a53f0a46f018bc2c56e58d383f2305e0975972c26feea0eb122fe7893c15af376b33edf7de17c6ea056d4d82de6bc02f<a href="#appendix-A.1-3.9" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-3.10">beta = a3ad7b0ef73d8fc6655053ea22f9bede8c743f08bbed3d38821f0e16474b505e<a href="#appendix-A.1-3.10" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-A.1-4">Example 2:<a href="#appendix-A.1-4" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty">
<li class="compact ulEmpty" id="appendix-A.1-5.1">SK = x = c9afa9d845ba75166b5c215767b1d6934e50c3db36e89b127b8a622b120f6721<a href="#appendix-A.1-5.1" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-5.2">PK = 0360fed4ba255a9d31c961eb74c6356d68c049b8923b61fa6ce669622e60f29fb6<a href="#appendix-A.1-5.2" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-5.3">alpha = 74657374 (ASCII "test")<a href="#appendix-A.1-5.3" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-5.4">try_and_increment succeeded on ctr = 3<a href="#appendix-A.1-5.4" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-5.5">H = 02173119b4fff5e6f8afed4868a29fe8920f1b54c2cf89cc7b301d0d473de6b974<a href="#appendix-A.1-5.5" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-5.6">k = 5852353a868bdce26938cde1826723e58bf8cb06dd2fed475213ea6f3b12e961<a href="#appendix-A.1-5.6" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-5.7">U = k*B = 022779a2cafcb65414c4a04a4b4d2adf4c50395f57995e89e6de823250d91bc48e<a href="#appendix-A.1-5.7" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-5.8">V = k*H = 033b4a14731672e82339f03b45ff6b5b13dee7ada38c9bf1d6f8f61e2ce5921119<a href="#appendix-A.1-5.8" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-5.9">pi = 034dac60aba508ba0c01aa9be80377ebd7562c4a52d74722e0abae7dc3080ddb56c19e067b15a8a8174905b13617804534214f935b94c2287f797e393eb0816969d864f37625b443f30f1a5a33f2b3c854<a href="#appendix-A.1-5.9" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-5.10">beta = a284f94ceec2ff4b3794629da7cbafa49121972671b466cab4ce170aa365f26d<a href="#appendix-A.1-5.10" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-A.1-6">The example secret key in Example 3 is taken from Appendix L.4.2 of <span>[<a href="#ANSI.X9-62-2005" class="xref">ANSI.X9-62-2005</a>]</span>.<a href="#appendix-A.1-6" class="pilcrow">¶</a></p>
<p id="appendix-A.1-7">Example 3:<a href="#appendix-A.1-7" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty">
<li class="compact ulEmpty" id="appendix-A.1-8.1">SK = x = 2ca1411a41b17b24cc8c3b089cfd033f1920202a6c0de8abb97df1498d50d2c8<a href="#appendix-A.1-8.1" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-8.2">PK = 03596375e6ce57e0f20294fc46bdfcfd19a39f8161b58695b3ec5b3d16427c274d<a href="#appendix-A.1-8.2" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-8.3">alpha = 4578616d706c65207573696e67204543445341206b65792066726f6d20417070656e646978204c2e342e32206f6620414e53492e58392d36322d32303035 (ASCII "Example using ECDSA key from Appendix L.4.2 of ANSI.X9-62-2005")<a href="#appendix-A.1-8.3" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-8.4">try_and_increment succeeded on ctr = 1<a href="#appendix-A.1-8.4" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-8.5">H = 0258055c26c4b01d01c00fb57567955f7d39cd6f6e85fd37c58f696cc6b7aa761d<a href="#appendix-A.1-8.5" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-8.6">k = 5689e2e08e1110b4dda293ac21667eac6db5de4a46a519c73d533f69be2f4da3<a href="#appendix-A.1-8.6" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-8.7">U = k*B = 020f465cd0ec74d2e23af0abde4c07e866ae4e5138bded5dd1196b8843f380db84<a href="#appendix-A.1-8.7" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-8.8">V = k*H = 036cb6f811428fc4904370b86c488f60c280fa5b496d2f34ff8772f60ed24b2d1d<a href="#appendix-A.1-8.8" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-8.9">pi = 03d03398bf53aa23831d7d1b2937e005fb0062cbefa06796579f2a1fc7e7b8c667d091c00b0f5c3619d10ecea44363b5a599cadc5b2957e223fec62e81f7b4825fc799a771a3d7334b9186bdbee87316b1<a href="#appendix-A.1-8.9" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.1-8.10">beta = 90871e06da5caa39a3c61578ebb844de8635e27ac0b13e829997d0d95dd98c19<a href="#appendix-A.1-8.10" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="appendix-A.2">
        <h3 id="name-ecvrf-p256-sha256-sswu">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-ecvrf-p256-sha256-sswu" class="section-name selfRef">ECVRF-P256-SHA256-SSWU</a>
        </h3>
<p id="appendix-A.2-1">The example secret keys and messages in Examples 4 and 5 are taken from Appendix A.2.5 of <span>[<a href="#RFC6979" class="xref">RFC6979</a>]</span>.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">Example 4:<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty">
<li class="compact ulEmpty" id="appendix-A.2-3.1">SK = x = c9afa9d845ba75166b5c215767b1d6934e50c3db36e89b127b8a622b120f6721<a href="#appendix-A.2-3.1" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-3.2">PK = 0360fed4ba255a9d31c961eb74c6356d68c049b8923b61fa6ce669622e60f29fb6<a href="#appendix-A.2-3.2" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-3.3">alpha = 73616d706c65 (ASCII "sample")<a href="#appendix-A.2-3.3" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-3.4">In SSWU: uniform_bytes = 5024e98d6067dec313af09ff0cbe78218324a645c2a4b0aae2453f6fe91aa3bd9471f7b4a5fbf128e4b53f0c59603f7e<a href="#appendix-A.2-3.4" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-3.5">In SSWU: u = df565615a2372e8b31b8771f7503bafc144e48b05688b97958cc27ce29a8d810<a href="#appendix-A.2-3.5" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-3.6">In SSWU: x1 = e7e39eb8a4c982426fcff629e55a3e13516cfeb62c02c369b1e750316f5e94eb<a href="#appendix-A.2-3.6" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-3.7">In SSWU: gx1 is a nonsquare<a href="#appendix-A.2-3.7" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-3.8">H = 02b31973e872d4a097e2cfae9f37af9f9d73428fde74ac537dda93b5f18dbc5842<a href="#appendix-A.2-3.8" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-3.9">k = e92820035a0a8afe132826c6312662b6ea733fc1a0d33737945016de54d02dd8<a href="#appendix-A.2-3.9" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-3.10">U = k*B = 031490f49d0355ffcdf66e40df788bee93861917ee713acff79be40d20cc91a30a<a href="#appendix-A.2-3.10" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-3.11">V = k*H = 03701df0228138fa3d16612c0d720389326b3265151bc7ac696ea4d0591cd053e3<a href="#appendix-A.2-3.11" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-3.12">pi = 0331d984ca8fece9cbb9a144c0d53df3c4c7a33080c1e02ddb1a96a365394c7888782fffde7b842c38c20c08de6ec6c2e7027a97000f2c9fa4425d5c03e639fb48fde58114d755985498d7eb234cf4aed9<a href="#appendix-A.2-3.12" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-3.13">beta = 21e66dc9747430f17ed9efeda054cf4a264b097b9e8956a1787526ed00dc664b<a href="#appendix-A.2-3.13" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-A.2-4">Example 5:<a href="#appendix-A.2-4" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty">
<li class="compact ulEmpty" id="appendix-A.2-5.1">SK = x = c9afa9d845ba75166b5c215767b1d6934e50c3db36e89b127b8a622b120f6721<a href="#appendix-A.2-5.1" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-5.2">PK = 0360fed4ba255a9d31c961eb74c6356d68c049b8923b61fa6ce669622e60f29fb6<a href="#appendix-A.2-5.2" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-5.3">alpha = 74657374 (ASCII "test")<a href="#appendix-A.2-5.3" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-5.4">In SSWU: uniform_bytes = 910cc66d84a57985a1d15843dad83fd9138a109afb243b7fa5d64d766ec9ca3894fdcf46ebeb21a3972eb452a4232fd3<a href="#appendix-A.2-5.4" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-5.5">In SSWU: u = d8b0107f7e7aa36390240d834852f8703a6dc407019d6196bda5861b8fc00181<a href="#appendix-A.2-5.5" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-5.6">In SSWU: x1 = ccc747fa7318b9486ce4044adbbecaa084c27be6eda88eb7b7f3d688fd0968c7<a href="#appendix-A.2-5.6" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-5.7">In SSWU: gx1 is a square<a href="#appendix-A.2-5.7" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-5.8">H = 03ccc747fa7318b9486ce4044adbbecaa084c27be6eda88eb7b7f3d688fd0968c7<a href="#appendix-A.2-5.8" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-5.9">k = febc3451ea7639fde2cf41ffd03f463124ecb3b5a79913db1ed069147c8a7dea<a href="#appendix-A.2-5.9" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-5.10">U = k*B = 031200f9900e96f811d1247d353573f47e0d9da601fc992566234fc1a5b37749ae<a href="#appendix-A.2-5.10" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-5.11">V = k*H = 02d3715dcfee136c7ae50e95ffca76f4ca6c29ddfb92a39c31a0d48e75c6605cd1<a href="#appendix-A.2-5.11" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-5.12">pi = 03f814c0455d32dbc75ad3aea08c7e2db31748e12802db23640203aebf1fa8db2743aad348a3006dc1caad7da28687320740bf7dd78fe13c298867321ce3b36b79ec3093b7083ac5e4daf3465f9f43c627<a href="#appendix-A.2-5.12" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-5.13">beta = 8e7185d2b420e4f4681f44ce313a26d05613323837da09a69f00491a83ad25dd<a href="#appendix-A.2-5.13" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-A.2-6">The example secret key in Example 6 is taken from Appendix L.4.2 of <span>[<a href="#ANSI.X9-62-2005" class="xref">ANSI.X9-62-2005</a>]</span>.<a href="#appendix-A.2-6" class="pilcrow">¶</a></p>
<p id="appendix-A.2-7">Example 6:<a href="#appendix-A.2-7" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty">
<li class="compact ulEmpty" id="appendix-A.2-8.1">SK = x = 2ca1411a41b17b24cc8c3b089cfd033f1920202a6c0de8abb97df1498d50d2c8<a href="#appendix-A.2-8.1" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-8.2">PK = 03596375e6ce57e0f20294fc46bdfcfd19a39f8161b58695b3ec5b3d16427c274d<a href="#appendix-A.2-8.2" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-8.3">alpha = 4578616d706c65207573696e67204543445341206b65792066726f6d20417070656e646978204c2e342e32206f6620414e53492e58392d36322d32303035 (ASCII "Example using ECDSA key from Appendix L.4.2 of ANSI.X9-62-2005")<a href="#appendix-A.2-8.3" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-8.4">In SSWU: uniform_bytes = 9b81d55a242d3e8438d3bcfb1bee985a87fd144802c9268cf9adeee160e6e9ff765569797a0f701cb4316018de2e7dd4<a href="#appendix-A.2-8.4" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-8.5">In SSWU: u = e43c98c2ae06d13839fedb0303e5ee815896beda39be83fb11325b97976efdce<a href="#appendix-A.2-8.5" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-8.6">In SSWU: x1 = be9e195a50f175d3563aed8dc2d9f513a5536c1e9aee1757d86c08d32d582a86<a href="#appendix-A.2-8.6" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-8.7">In SSWU: gx1 is a nonsquare<a href="#appendix-A.2-8.7" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-8.8">H = 022dd5150e5a2a24c66feab2f68532be1486e28e07f1b9a055cf38ccc16f6595ff<a href="#appendix-A.2-8.8" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-8.9">k = 8e29221f33564f3f66f858ba2b0c14766e1057adbd422c3e7d0d99d5e142b613<a href="#appendix-A.2-8.9" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-8.10">U = k*B = 03a8823ff9fd16bf879261c740b9c7792b77fee0830f21314117e441784667958d<a href="#appendix-A.2-8.10" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-8.11">V = k*H = 02d48fbb45921c755b73b25be2f23379e3ce69294f6cee9279815f57f4b422659d<a href="#appendix-A.2-8.11" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-8.12">pi = 039f8d9cdc162c89be2871cbcb1435144739431db7fab437ab7bc4e2651a9e99d5488405a11a6c7fc8defddd9e1573a563b7333aab4effe73ae9803274174c659269fd39b53e133dcd9e0d24f01288de9<a href="#appendix-A.2-8.12" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.2-8.13">beta = 4fbadf33b42a5f42f23a6f89952d2e634a6e3810f15878b46ef1bb85a04fe95a<a href="#appendix-A.2-8.13" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="appendix-A.3">
        <h3 id="name-ecvrf-edwards25519-sha512-t">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-ecvrf-edwards25519-sha512-t" class="section-name selfRef">ECVRF-EDWARDS25519-SHA512-TAI</a>
        </h3>
<p id="appendix-A.3-1">The example secret keys and messages in Examples 7, 8, and 9 are taken from Section 7.1 of <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<p id="appendix-A.3-2">Example 7:<a href="#appendix-A.3-2" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty">
<li class="compact ulEmpty" id="appendix-A.3-3.1">SK = 9d61b19deffd5a60ba844af492ec2cc44449c5697b326919703bac031cae7f60<a href="#appendix-A.3-3.1" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-3.2">PK = d75a980182b10ab7d54bfed3c964073a0ee172f3daa62325af021a68f707511a<a href="#appendix-A.3-3.2" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-3.3">alpha =  (the empty string)<a href="#appendix-A.3-3.3" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-3.4">x = 307c83864f2833cb427a2ef1c00a013cfdff2768d980c0a3a520f006904de94f<a href="#appendix-A.3-3.4" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-3.5">try_and_increment succeeded on ctr = 0<a href="#appendix-A.3-3.5" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-3.6"> H = 91bbed02a99461df1ad4c6564a5f5d829d0b90cfc7903e7a5797bd658abf3318<a href="#appendix-A.3-3.6" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-3.7">k = 7100f3d9eadb6dc4743b029736ff283f5be494128df128df2817106f345b8594b6d6da2d6fb0b4c0257eb337675d96eab49cf39e66cc2c9547c2bf8b2a6afae4<a href="#appendix-A.3-3.7" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-3.8">U = k*B = aef27c725be964c6a9bf4c45ca8e35df258c1878b838f37d9975523f09034071<a href="#appendix-A.3-3.8" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-3.9">V = k*H = 5016572f71466c646c119443455d6cb9b952f07d060ec8286d678615d55f954f<a href="#appendix-A.3-3.9" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-3.10">pi = 8657106690b5526245a92b003bb079ccd1a92130477671f6fc01ad16f26f723f26f8a57ccaed74ee1b190bed1f479d9727d2d0f9b005a6e456a35d4fb0daab1268a1b0db10836d9826a528ca76567805<a href="#appendix-A.3-3.10" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-3.11">beta = 90cf1df3b703cce59e2a35b925d411164068269d7b2d29f3301c03dd757876ff66b71dda49d2de59d03450451af026798e8f81cd2e333de5cdf4f3e140fdd8ae<a href="#appendix-A.3-3.11" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-A.3-4">Example 8:<a href="#appendix-A.3-4" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty">
<li class="compact ulEmpty" id="appendix-A.3-5.1">SK = 4ccd089b28ff96da9db6c346ec114e0f5b8a319f35aba624da8cf6ed4fb8a6fb<a href="#appendix-A.3-5.1" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-5.2">PK = 3d4017c3e843895a92b70aa74d1b7ebc9c982ccf2ec4968cc0cd55f12af4660c<a href="#appendix-A.3-5.2" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-5.3">alpha = 72 (1 byte)<a href="#appendix-A.3-5.3" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-5.4">x = 68bd9ed75882d52815a97585caf4790a7f6c6b3b7f821c5e259a24b02e502e51<a href="#appendix-A.3-5.4" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-5.5">try_and_increment succeeded on ctr = 1<a href="#appendix-A.3-5.5" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-5.6">H = 5b659fc3d4e9263fd9a4ed1d022d75eaacc20df5e09f9ea937502396598dc551<a href="#appendix-A.3-5.6" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-5.7">k = 42589bbf0c485c3c91c1621bb4bfe04aed7be76ee48f9b00793b2342acb9c167cab856f9f9d4febc311330c20b0a8afd3743d05433e8be8d32522ecdc16cc5ce<a href="#appendix-A.3-5.7" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-5.8">U = k*B = 1dcb0a4821a2c48bf53548228b7f170962988f6d12f5439f31987ef41f034ab3<a href="#appendix-A.3-5.8" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-5.9">V = k*H = fd03c0bf498c752161bae4719105a074630a2aa5f200ff7b3995f7bfb1513423<a href="#appendix-A.3-5.9" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-5.10">pi = f3141cd382dc42909d19ec5110469e4feae18300e94f304590abdced48aed5933bf0864a62558b3ed7f2fea45c92a465301b3bbf5e3e54ddf2d935be3b67926da3ef39226bbc355bdc9850112c8f4b02<a href="#appendix-A.3-5.10" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-5.11">beta = eb4440665d3891d668e7e0fcaf587f1b4bd7fbfe99d0eb2211ccec90496310eb5e33821bc613efb94db5e5b54c70a848a0bef4553a41befc57663b56373a5031<a href="#appendix-A.3-5.11" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-A.3-6">Example 9:<a href="#appendix-A.3-6" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty">
<li class="compact ulEmpty" id="appendix-A.3-7.1">SK = c5aa8df43f9f837bedb7442f31dcb7b166d38535076f094b85ce3a2e0b4458f7<a href="#appendix-A.3-7.1" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-7.2">PK = fc51cd8e6218a1a38da47ed00230f0580816ed13ba3303ac5deb911548908025<a href="#appendix-A.3-7.2" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-7.3">alpha = af82 (2 bytes)<a href="#appendix-A.3-7.3" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-7.4">x = 909a8b755ed902849023a55b15c23d11ba4d7f4ec5c2f51b1325a181991ea95c<a href="#appendix-A.3-7.4" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-7.5">try_and_increment succeeded on ctr = 0<a href="#appendix-A.3-7.5" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-7.6">H = bf4339376f5542811de615e3313d2b36f6f53c0acfebb482159711201192576a<a href="#appendix-A.3-7.6" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-7.7">k = 38b868c335ccda94a088428cbf3ec8bc7955bfaffe1f3bd2aa2c59fc31a0febc59d0e1af3715773ce11b3bbdd7aba8e3505d4b9de6f7e4a96e67e0d6bb6d6c3a<a href="#appendix-A.3-7.7" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-7.8">U = k*B = 2bae73e15a64042fcebf062abe7e432b2eca6744f3e8265bc38e009cd577ecd5<a href="#appendix-A.3-7.8" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-7.9">V = k*H = 88cba1cb0d4f9b649d9a86026b69de076724a93a65c349c988954f0961c5d506<a href="#appendix-A.3-7.9" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-7.10">pi = 9bc0f79119cc5604bf02d23b4caede71393cedfbb191434dd016d30177ccbf8096bb474e53895c362d8628ee9f9ea3c0e52c7a5c691b6c18c9979866568add7a2d41b00b05081ed0f58ee5e31b3a970e<a href="#appendix-A.3-7.10" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.3-7.11">beta = 645427e5d00c62a23fb703732fa5d892940935942101e456ecca7bb217c61c452118fec1219202a0edcf038bb6373241578be7217ba85a2687f7a0310b2df19f<a href="#appendix-A.3-7.11" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="appendix-A.4">
        <h3 id="name-ecvrf-edwards25519-sha512-e">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-ecvrf-edwards25519-sha512-e" class="section-name selfRef">ECVRF-EDWARDS25519-SHA512-ELL2</a>
        </h3>
<p id="appendix-A.4-1">The example secret keys and messages in Examples 10, 11, and 12 are taken from Section 7.1 of <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.<a href="#appendix-A.4-1" class="pilcrow">¶</a></p>
<p id="appendix-A.4-2">Example 10:<a href="#appendix-A.4-2" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty">
<li class="compact ulEmpty" id="appendix-A.4-3.1">SK = 9d61b19deffd5a60ba844af492ec2cc44449c5697b326919703bac031cae7f60<a href="#appendix-A.4-3.1" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-3.2">PK = d75a980182b10ab7d54bfed3c964073a0ee172f3daa62325af021a68f707511a<a href="#appendix-A.4-3.2" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-3.3">alpha =  (the empty string)<a href="#appendix-A.4-3.3" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-3.4">x = 307c83864f2833cb427a2ef1c00a013cfdff2768d980c0a3a520f006904de94f<a href="#appendix-A.4-3.4" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-3.5">In Elligator2: uniform_bytes = d620782a206d9de584b74e23ae5ee1db5ca5298b3fc527c4867f049dee6dd419b3674967bd614890f621c128d72269ae<a href="#appendix-A.4-3.5" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-3.6">In Elligator2: u = 30f037b9745a57a9a2b8a68da81f397c39d46dee9d047f86c427c53f8b29a55c<a href="#appendix-A.4-3.6" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-3.7">In Elligator2: gx1 = 8cb66318fb2cea01672d6c27a5ab662ae33220961607f69276080a56477b4a08<a href="#appendix-A.4-3.7" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-3.8">In Elligator2: gx1 is a square<a href="#appendix-A.4-3.8" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-3.9">H = b8066ebbb706c72b64390324e4a3276f129569eab100c26b9f05011200c1bad9<a href="#appendix-A.4-3.9" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-3.10">k = b5682049fee54fe2d519c9afff73bbfad724e69a82d5051496a42458f817bed7a386f96b1a78e5736756192aeb1818a20efb336a205ffede351cfe88dab8d41c<a href="#appendix-A.4-3.10" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-3.11">U = k*B = 762f5c178b68f0cddcc1157918edf45ec334ac8e8286601a3256c3bbf858edd9<a href="#appendix-A.4-3.11" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-3.12">V = k*H = 4652eba1c4612e6fce762977a59420b451e12964adbe4fbecd58a7aeff5860af<a href="#appendix-A.4-3.12" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-3.13">pi = 7d9c633ffeee27349264cf5c667579fc583b4bda63ab71d001f89c10003ab46f14adf9a3cd8b8412d9038531e865c341cafa73589b023d14311c331a9ad15ff2fb37831e00f0acaa6d73bc9997b06501<a href="#appendix-A.4-3.13" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-3.14">beta = 9d574bf9b8302ec0fc1e21c3ec5368269527b87b462ce36dab2d14ccf80c53cccf6758f058c5b1c856b116388152bbe509ee3b9ecfe63d93c3b4346c1fbc6c54<a href="#appendix-A.4-3.14" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-A.4-4">Example 11:<a href="#appendix-A.4-4" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty">
<li class="compact ulEmpty" id="appendix-A.4-5.1">SK = 4ccd089b28ff96da9db6c346ec114e0f5b8a319f35aba624da8cf6ed4fb8a6fb<a href="#appendix-A.4-5.1" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-5.2">PK = 3d4017c3e843895a92b70aa74d1b7ebc9c982ccf2ec4968cc0cd55f12af4660c<a href="#appendix-A.4-5.2" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-5.3">alpha = 72 (1 byte)<a href="#appendix-A.4-5.3" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-5.4">x = 68bd9ed75882d52815a97585caf4790a7f6c6b3b7f821c5e259a24b02e502e51<a href="#appendix-A.4-5.4" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-5.5">In Elligator2: uniform_bytes = 04ae20a9ad2a2330fb33318e376a2448bd77bb99e81d126f47952b156590444a9225b84128b66a2f15b41294fa2f2f6d<a href="#appendix-A.4-5.5" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-5.6">In Elligator2: u = 3092f033b16d4d5f74a3f7dc7091fe434b449065152b95476f121de899bb773d<a href="#appendix-A.4-5.6" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-5.7">In Elligator2: gx1 = 25d7fe7f82456e7078e99fdb24ef2582b4608357cdba9c39a8d535a3fd98464d<a href="#appendix-A.4-5.7" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-5.8">In Elligator2: gx1 is a nonsquare<a href="#appendix-A.4-5.8" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-5.9">H = 76ac3ccb86158a9104dff819b1ca293426d305fd76b39b13c9356d9b58c08e57<a href="#appendix-A.4-5.9" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-5.10">k = 88bf479281fd29a6cbdffd67e2c5ec0024d92f14eaed58f43f22f37c4c37f1d41e65c036fbf01f9fba11d554c07494d0c02e7e5c9d64be88ef78cab7544e444d<a href="#appendix-A.4-5.10" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-5.11">U = k*B = 8ec26e77b8cb3114dd2265fe1564a4efb40d109aa3312536d93dfe3d8d80a061<a href="#appendix-A.4-5.11" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-5.12">V = k*H = fe799eb5770b4e3a5a27d22518bb631db183c8316bb552155f442c62a47d1c8b<a href="#appendix-A.4-5.12" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-5.13">pi = 47b327393ff2dd81336f8a2ef10339112401253b3c714eeda879f12c509072ef055b48372bb82efbdce8e10c8cb9a2f9d60e93908f93df1623ad78a86a028d6bc064dbfc75a6a57379ef855dc6733801<a href="#appendix-A.4-5.13" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-5.14">beta = 38561d6b77b71d30eb97a062168ae12b667ce5c28caccdf76bc88e093e4635987cd96814ce55b4689b3dd2947f80e59aac7b7675f8083865b46c89b2ce9cc735<a href="#appendix-A.4-5.14" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-A.4-6">Example 12:<a href="#appendix-A.4-6" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty">
<li class="compact ulEmpty" id="appendix-A.4-7.1">SK = c5aa8df43f9f837bedb7442f31dcb7b166d38535076f094b85ce3a2e0b4458f7<a href="#appendix-A.4-7.1" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-7.2">PK = fc51cd8e6218a1a38da47ed00230f0580816ed13ba3303ac5deb911548908025<a href="#appendix-A.4-7.2" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-7.3">alpha = af82 (2 bytes)<a href="#appendix-A.4-7.3" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-7.4">x = 909a8b755ed902849023a55b15c23d11ba4d7f4ec5c2f51b1325a181991ea95c<a href="#appendix-A.4-7.4" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-7.5">In Elligator2: uniform_bytes = be0aed556e36cdfddf8f1eeddbb7356a24fad64cf95a922a098038f215588b216beabbfe6acf20256188e883292b7a3a<a href="#appendix-A.4-7.5" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-7.6">In Elligator2: u = f6675dc6d17fc790d4b3f1c6acf689a13d8b5815f23880092a925af94cd6fa24<a href="#appendix-A.4-7.6" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-7.7">In Elligator2: gx1 = a63d48e3247c903e22fdfb88fd9295e396712a5fe576af335dbe16f99f0af26c<a href="#appendix-A.4-7.7" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-7.8">In Elligator2: gx1 is a square<a href="#appendix-A.4-7.8" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-7.9">H = 13d2a8b5ca32db7e98094a61f656a08c6c964344e058879a386a947a4e189ed1<a href="#appendix-A.4-7.9" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-7.10">k = a7ddd74a3a7d165d511b02fa268710ddbb3b939282d276fa2efcfa5aaf79cf576087299ca9234aacd7cd674d912deba00f4e291733ef189a51e36c861b3d683b<a href="#appendix-A.4-7.10" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-7.11">U = k*B = a012f35433df219a88ab0f9481f4e0065d00422c3285f3d34a8b0202f20bac60<a href="#appendix-A.4-7.11" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-7.12">V = k*H = fb613986d171b3e98319c7ca4dc44c5dd8314a6e5616c1a4f16ce72bd7a0c25a<a href="#appendix-A.4-7.12" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-7.13">pi = 926e895d308f5e328e7aa159c06eddbe56d06846abf5d98c2512235eaa57fdce35b46edfc655bc828d44ad09d1150f31374e7ef73027e14760d42e77341fe05467bb286cc2c9d7fde29120a0b2320d04<a href="#appendix-A.4-7.13" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="appendix-A.4-7.14">beta = 121b7f9b9aaaa29099fc04a94ba52784d44eac976dd1a3cca458733be5cd090a7b5fbd148444f17f8daf1fb55cb04b1ae85a626e30a54b4b0f8abf4a43314a58<a href="#appendix-A.4-7.14" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Sharon Goldberg</span></div>
<div dir="auto" class="left"><span class="org">Boston University</span></div>
<div dir="auto" class="left"><span class="street-address">111 Cummington Mall</span></div>
<div dir="auto" class="left">
<span class="locality">Boston</span>, <span class="region">MA</span> <span class="postal-code">02215</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:goldbe@cs.bu.edu" class="email">goldbe@cs.bu.edu</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Leonid Reyzin</span></div>
<div dir="auto" class="left"><span class="org">Boston University and Algorand</span></div>
<div dir="auto" class="left"><span class="street-address">111 Cummington Mall</span></div>
<div dir="auto" class="left">
<span class="locality">Boston</span>, <span class="region">MA</span> <span class="postal-code">02215</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:reyzin@bu.edu" class="email">reyzin@bu.edu</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dimitrios Papadopoulos</span></div>
<div dir="auto" class="left"><span class="org">Hong Kong University of Science and Technology</span></div>
<div dir="auto" class="left"><span class="street-address">Clearwater Bay</span></div>
<div dir="auto" class="left"><span class="country-name">Hong Kong</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dipapado@cse.ust.hk" class="email">dipapado@cse.ust.hk</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jan Vcelak</span></div>
<div dir="auto" class="left"><span class="org">NS1</span></div>
<div dir="auto" class="left"><span class="street-address">16 Beaver St</span></div>
<div dir="auto" class="left">
<span class="locality">New York</span>, <span class="region">NY</span> <span class="postal-code">10004</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jvcelak@ns1.com" class="email">jvcelak@ns1.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
